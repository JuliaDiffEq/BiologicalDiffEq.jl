<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Plotting Spatial Simulations · Catalyst.jl</title><meta name="title" content="Plotting Spatial Simulations · Catalyst.jl"/><meta property="og:title" content="Plotting Spatial Simulations · Catalyst.jl"/><meta property="twitter:title" content="Plotting Spatial Simulations · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/lattice_simulation_plotting/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/lattice_simulation_plotting/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/spatial_modelling/lattice_simulation_plotting/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../../model_creation/dsl_basics/">The Catalyst DSL - Introduction</a></li><li><a class="tocitem" href="../../model_creation/dsl_advanced/">The Catalyst DSL - Advanced Features and Options</a></li><li><a class="tocitem" href="../../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../model_creation/model_file_loading_and_export/">Loading Chemical Reaction Network Models from Files</a></li><li><a class="tocitem" href="../../model_creation/model_visualisation/">Model Visualisation</a></li><li><a class="tocitem" href="../../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-11" type="checkbox"/><label class="tocitem" for="menuitem-3-11"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_creation/examples/basic_CRN_library/">Library of Basic Chemical Reaction Network Models</a></li><li><a class="tocitem" href="../../model_creation/examples/programmatic_generative_linear_pathway/">Programmatic, generative, modelling of a linear pathway</a></li><li><a class="tocitem" href="../../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../../model_simulation/simulation_introduction/">Model Simulation Introduction</a></li><li><a class="tocitem" href="../../model_simulation/simulation_plotting/">Simulation plotting</a></li><li><a class="tocitem" href="../../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../model_simulation/ensemble_simulations/">Ensemble/Monte Carlo Simulations</a></li><li><a class="tocitem" href="../../model_simulation/ode_simulation_performance/">Advice for performant ODE simulations</a></li><li><a class="tocitem" href="../../model_simulation/sde_simulation_performance/">Advice for performant SDE simulations</a></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl and SteadyStateDiffEq.jl</a></li><li><a class="tocitem" href="../../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li><li><a class="tocitem" href="../../steady_state_functionality/dynamical_systems/">Analysing model steady state properties with DynamicalSystems.jl</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../../inverse_problems/behaviour_optimisation/">Optimization for non-data fitting purposes</a></li><li><a class="tocitem" href="../../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><a class="tocitem" href="../../inverse_problems/global_sensitivity_analysis/">Global Sensitivity Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial Modelling</span><ul><li><a class="tocitem" href="../lattice_reaction_systems/">Introduction to spatial modelling with Catalyst</a></li><li><a class="tocitem" href="../lattice_simulation_structure_ interaction/">Interacting with and Plotting Spatial Lattice Simulations</a></li><li class="is-active"><a class="tocitem" href>Plotting Spatial Simulations</a><ul class="internal"><li><a class="tocitem" href="#lattice_simulation_plotting_2d_grid_animations"><span>Animations of 2d Cartesian or masked lattices</span></a></li></ul></li><li><a class="tocitem" href="../spatial_ode_simulations/">Spatial ODE simulations</a></li><li><a class="tocitem" href="../spatial_jump_simulations/">Spatial jump simulations</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Spatial Modelling</a></li><li class="is-active"><a href>Plotting Spatial Simulations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Plotting Spatial Simulations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/spatial_modelling/lattice_simulation_plotting.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="lattice_simulation_plotting"><a class="docs-heading-anchor" href="#lattice_simulation_plotting">Plotting Spatial Simulations</a><a id="lattice_simulation_plotting-1"></a><a class="docs-heading-anchor-permalink" href="#lattice_simulation_plotting" title="Permalink"></a></h1><p>To aid the investigation of spatial simulations we have implemented a helper functions for creating plots and animation of the simulations. The development of these functions are currently under development, with entries being added here as they are created. A list of currently implemented spatial plotting functions can be found in the <a href="../../api/#api">api</a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The plotting interfaces used for non-spatial Catalyst simulations have seen lots of work to ensure high quality plots. However, the corresponding functions for spatial simulations are primarily intended to aid the user to investigate their simulation results. Thus, they might not be fully suitable for e.g. creating publication-quality graphics. If you are using these functions, please let us now. This helps inform us whether continued development of spatial modelling features is worthwhile. </p></div></div><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>To create animations we use <a href="https://docs.makie.org/stable/">Makie.jl</a>, which is an alternative plotting package to <a href="https://github.com/JuliaPlots/Plots.jl">Plots.jl</a> (which is typically the preferred plotting package within the context of Catalyst). Generally, Makie is good at creating animations, hence we use it here (however, it is also a <a href="https://juliapackagecomparisons.github.io/pages/plotting/">popular competitor to Plots.jl for general-purpose plotting</a>). </p></div></div><div class="admonition is-category-warn"><header class="admonition-header">Warn</header><div class="admonition-body"><p>These plotting interfaces are very much a work in progress. Hence, they and their interfaces may see more change that Catalyst features typically do. This include <em>the possibility of breaking changes without breaking releases to Catalyst</em>.</p></div></div><h2 id="lattice_simulation_plotting_2d_grid_animations"><a class="docs-heading-anchor" href="#lattice_simulation_plotting_2d_grid_animations">Animations of 2d Cartesian or masked lattices</a><a id="lattice_simulation_plotting_2d_grid_animations-1"></a><a class="docs-heading-anchor-permalink" href="#lattice_simulation_plotting_2d_grid_animations" title="Permalink"></a></h2><p>Spatial simulations based on two dimensional [Cartesian] or [masked] lattices can both be animated using the same <code>lattice_animation</code> function. It four three arguments, the simulation you which animate, the species which values to display, the name of the file to which you wish to save the simulation, and the <code>LatticeReactionSystem</code> which was simulated. Here we first create and simulate a spatial <a href="../../model_creation/examples/basic_CRN_library/#basic_CRN_library_brusselator">Brusselator</a> model.</p><pre><code class="language-julia hljs">using Catalyst, OrdinaryDiffEq
brusselator = @reaction_network begin
    A, ∅ --&gt; X
    1, 2X + Y --&gt; 3X
    B, X --&gt; Y
    1, X --&gt; ∅
end
diffusion_rx = @transport_reaction D X
lattice = CartesianGrid((20,20))
lrs = LatticeReactionSystem(brusselator, [diffusion_rx], lattice)

u0 = [:X =&gt; rand(20, 20), :Y =&gt; 10.0]
tspan = (0.0, 40.0)
ps = [:A =&gt; 1.0, :B =&gt; 4.0, :D =&gt; 0.2]
oprob = ODEProblem(lrs, u0, tspan, ps)
sol = solve(oprob, FBDF())</code></pre><p>Next, we can animate it using the <code>lattice_animation</code> function, which requires the <a href="https://github.com/JuliaPlots/CairoMakie.jl">CairoMakie.jl</a> package:</p><pre><code class="language-julia hljs">using CairoMakie
lattice_animation(sol, :X, &quot;brusselator.mp4&quot;, lrs)</code></pre><video autoplay loop muted playsinline controls src="./brusselator.mp4" /><pre><code class="language-julia hljs">rm(&quot;brusselator.mp4&quot;)</code></pre><p>Here, <code>lattice_animation</code> takes various additional optional arguments that can be useful:</p><ul><li><code>colormap</code>: The <a href="https://docs.makie.org/v0.21/explanations/colors#misc">colour map</a> to used in the heatmap to display the change in species amounts. The default value is <code>:BuGn_7</code>.</li><li><code>nframes</code>: The number of frames in the animation. These are sampled evenly across the simulation timespan. The default value is <code>200</code>.</li><li><code>framerate</code>: The animations framerate. The default value is <code>20</code>.</li><li>Many additional arguments which can be provided to normal Makie heat maps can be provided to <code>lattice_animation</code> as well.</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lattice_simulation_structure_ interaction/">« Interacting with and Plotting Spatial Lattice Simulations</a><a class="docs-footer-nextpage" href="../spatial_ode_simulations/">Spatial ODE simulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 12 July 2024 19:56">Friday 12 July 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
