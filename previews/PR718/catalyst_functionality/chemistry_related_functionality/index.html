<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Chemistry-related functionality · Catalyst.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/catalyst_functionality/chemistry_related_functionality/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Catalyst Functionality</span><ul><li><a class="tocitem" href="../dsl_description/">The Reaction DSL</a></li><li><a class="tocitem" href="../programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../network_analysis/">Network Analysis in Catalyst</a></li><li class="is-active"><a class="tocitem" href>Chemistry-related functionality</a><ul class="internal"><li><a class="tocitem" href="#Modelling-with-compound-species"><span>Modelling with compound species</span></a></li><li><a class="tocitem" href="#Balancing-chemical-reactions"><span>Balancing chemical reactions</span></a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../example_networks/basic_CRN_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../example_networks/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../example_networks/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Catalyst Applications</span><ul><li><a class="tocitem" href="../../catalyst_applications/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../catalyst_applications/advanced_simulations/">Advanced Simulation Options</a></li><li><a class="tocitem" href="../../catalyst_applications/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../catalyst_applications/bifurcation_diagrams/">Bifurcation Diagrams</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../../inverse_problems/parameter_estimation/">Parameter Estimation</a></li><li><a class="tocitem" href="../../inverse_problems/petab_ode_param_fitting/">Parameter Fitting for ODEs using PEtab.jl</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/catalyst_api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Catalyst Functionality</a></li><li class="is-active"><a href>Chemistry-related functionality</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Chemistry-related functionality</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/catalyst_functionality/chemistry_related_functionality.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="chemistry_functionality"><a class="docs-heading-anchor" href="#chemistry_functionality">Chemistry-related functionality</a><a id="chemistry_functionality-1"></a><a class="docs-heading-anchor-permalink" href="#chemistry_functionality" title="Permalink"></a></h1><p>While Catalyst has primarily been designed around the modelling of biological systems, reaction network models are also common across chemistry. This section describes two types of functionality, that while of general interest, should be especially useful in the modelling of chemical systems.</p><ul><li>The <code>@compound</code> option, allowing the user to designate that a specific species is composed of certain subspecies.</li><li>The <code>balance_reaction</code> function enabling the user to balance a reaction so the same number of components occur on both sides.</li></ul><h2 id="Modelling-with-compound-species"><a class="docs-heading-anchor" href="#Modelling-with-compound-species">Modelling with compound species</a><a id="Modelling-with-compound-species-1"></a><a class="docs-heading-anchor-permalink" href="#Modelling-with-compound-species" title="Permalink"></a></h2><p>Defining compound species is currently only supported for <a href="../programmatic_CRN_construction/#programmatic_CRN_construction">programmatic construction</a> of reactions and reaction network models. To create a compound species, use the <code>@compound</code> macro, first designating the compound, followed by its components (and stoichiometries). In this example, we will create a CO₂ compound species, consisting of one C species and two O species. First, we create species corresponding to the components:</p><pre><code class="language- hljs">@variables t
@species C(t) O(t) </code></pre><p>Next, we create the <code>CO2</code> compound:</p><pre><code class="language- hljs">@compound CO2(t) = C + 2O</code></pre><p>Here, the compound is the first argument to the macro, followed by its component. The <code>(t)</code> indicates that <code>CO2</code> is a time dependant species. Components with non-unitary stoichiometries have this value written before the component (generally, the rules for designating the components of a compound are identical to those of designating the substrates or products of a reaction). The created compound, <code>CO2</code>, is a species in every sense, and can be used wherever e.g. <code>C</code> can be used:</p><pre><code class="language- hljs">isspecies(CO2)</code></pre><p>In its metadata, however, is stored information of its components, which can be retrieved using the <code>components</code> (returning a vector of its component species) and <code>coefficients</code> (returning a vector with each component&#39;s stoichiometry) functions:</p><pre><code class="language- hljs">components(CO2)</code></pre><pre><code class="language- hljs">coefficients(CO2)</code></pre><p>Alternatively, we can retrieve the components and their stoichiometric coefficients as a single vector using the <code>component_coefficients</code> function:</p><pre><code class="language- hljs">component_coefficients(CO2)</code></pre><p>Finally, it is possible to check whether a species is a compound or not using the <code>iscompound</code> function:</p><pre><code class="language- hljs">iscompound(CO2)</code></pre><p>Compound components that are also compounds are allowed, e.g. we can create a carbonic acid compound (H₂CO₃) that consists of CO₂ and H₂O:</p><pre><code class="language- hljs">@species H(t)
@compound H2O(t) = 2H + O
@compound H2CO3(t) = CO2 + H2O</code></pre><p>When multiple compounds are created, they can be created simultaneously using the <code>@compounds</code> macro, e.g. the previous code-block can be re-written as:</p><pre><code class="language- hljs">@species H(t)
@compounds begin
    H2O(t) = 2H + O
    H2CO3(t) = CO2 + H2O
end</code></pre><p>One use of defining a species as a compound is that they can be used to balance reactions to that the number of compounds are the same on both sides.</p><h2 id="Balancing-chemical-reactions"><a class="docs-heading-anchor" href="#Balancing-chemical-reactions">Balancing chemical reactions</a><a id="Balancing-chemical-reactions-1"></a><a class="docs-heading-anchor-permalink" href="#Balancing-chemical-reactions" title="Permalink"></a></h2><p>Catalyst provides the <code>balance_reaction</code> function, which takes a reaction, and returns a balanced version. E.g. let us consider a reaction when carbon dioxide is formed from carbon and oxide <code>C + O --&gt; CO2</code>. Here, <code>balance_reaction</code> enables us to find coefficients creating a balanced reaction (in this case, where the number of carbon and oxygen atoms are the same on both sides). To demonstrate, we first created the unbalanced reactions:</p><pre><code class="language- hljs">rx = @reaction k, C + O --&gt; $CO2</code></pre><p>Here, the reaction rate (<code>k</code>) is not involved in the reaction balancing. We use interpolation for <code>CO2</code>, ensuring that the <code>CO2</code> used in the reaction is the same one we previously defined as a compound of <code>C</code> and <code>O</code>. Next, we call the <code>balance_reaction</code> function</p><pre><code class="language- hljs">balance_reaction(rx)</code></pre><p>which correctly finds the (rather trivial) solution <code>C + 2O --&gt; CO2</code>. Here we note that <code>balance_reaction</code> actually returns a vector. The reason is that the reaction balancing problem may have several solutions. Typically, there is only a single solution (in which case this is the vector&#39;s only element). No, or an infinite number of, solutions is also possible.</p><p>Let us consider a more elaborate example, the reaction between ammonia (NH₃) and oxygen (O₂) to form nitrogen monoxide (NO) and water (H₂O). Let us first create the components and the unbalanced reaction:</p><pre><code class="language-julia hljs">@variables t
@species N(t) H(t) O(t)
@compounds begin
    NH3(t) = N + 3H
    O2(t) = 2O
    NO(t) = N + O
    H2O(t) = 2H + O
end
unbalanced_reaction = @reaction k, $NH3 + $O2 --&gt; $NO + $H2O</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">k, NH3 + O2 --&gt; NO + H2O</code></pre><p>We can now create a balanced version (where the amount of H, N, and O is the same on both sides):</p><pre><code class="language-julia hljs">balanced_reaction = balance_reaction(unbalanced_reaction)[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">k, 4*NH3 + 5*O2 --&gt; 4*NO + 6*H2O</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Reaction balancing is currently not supported for reactions involving compounds of compounds.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../network_analysis/">« Network Analysis in Catalyst</a><a class="docs-footer-nextpage" href="../example_networks/basic_CRN_examples/">Basic Chemical Reaction Network Examples »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 11 November 2023 00:28">Saturday 11 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
