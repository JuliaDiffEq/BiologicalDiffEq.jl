<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bifurcation Diagrams · Catalyst.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/catalyst_applications/bifurcation_diagrams/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Catalyst Functionality</span><ul><li><a class="tocitem" href="../../catalyst_functionality/dsl_description/">The Reaction DSL</a></li><li><a class="tocitem" href="../../catalyst_functionality/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../catalyst_functionality/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../catalyst_functionality/network_analysis/">Network Analysis in Catalyst</a></li></ul></li><li><span class="tocitem">Catalyst Applications</span><ul><li><a class="tocitem" href="../simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../advanced_simulations/">Advanced Simulation Options</a></li><li><a class="tocitem" href="../homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li class="is-active"><a class="tocitem" href>Bifurcation Diagrams</a></li><li><a class="tocitem" href="../parameter_estimation/">Parameter Estimation</a></li></ul></li><li><span class="tocitem">Example Networks</span><ul><li><a class="tocitem" href="../../example_networks/basic_CRN_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../../example_networks/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../example_networks/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/catalyst_api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Catalyst Applications</a></li><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bifurcation Diagrams</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/catalyst_applications/bifurcation_diagrams.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="bifurcation_diagrams"><a class="docs-heading-anchor" href="#bifurcation_diagrams">Bifurcation Diagrams</a><a id="bifurcation_diagrams-1"></a><a class="docs-heading-anchor-permalink" href="#bifurcation_diagrams" title="Permalink"></a></h1><p>Bifurcation diagrams can be produced for models generated by Catalyst through the use of the <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/">BifurcationKit.jl</a> package. This tutorial gives a simple example of how to create such a bifurcation diagram.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Catalyst 13.0 and up require at least BifurcationKit v0.2.4.</p></div></div><p>First, we declare our reaction model. For this example we will use a bistable switch, but one which also contains a Hopf bifurcation.</p><pre><code class="language-julia hljs">using Catalyst
rn = @reaction_network begin
    (v0 + v*(S * X)^n / ((S*X)^n + (D*A)^n + K^n), d), ∅ ↔ X
    (X/τ, 1/τ), ∅ ↔ A
end</code></pre><p class="math-container">\[ \begin{align*}
\varnothing &amp;\xrightleftharpoons[d]{v0 + \frac{v \left( S X \right)^{n}}{K^{n} + \left( A D \right)^{n} + \left( S X \right)^{n}}} \mathrm{X} \\
\varnothing &amp;\xrightleftharpoons[\frac{1}{\tau}]{\frac{X}{\tau}} \mathrm{A}  
 \end{align*}
 \]</p><p>Next, we specify the system parameters for which we wish to plot the bifurcation diagram. We also set the parameter we wish to vary in our bifurcation diagram, as well as the interval to vary it over. Finally, we set which variable we wish to plot the steady state values of in the bifurcation plot.</p><pre><code class="language-julia hljs">p = Dict(:S =&gt; 1., :D =&gt; 9., :τ =&gt; 1000., :v0 =&gt; 0.01,
         :v =&gt; 2., :K =&gt; 20., :n =&gt; 3, :d =&gt; 0.05)
bif_par = :S           # bifurcation parameter
p_span = (0.1, 20.)    # interval to vary S over
plot_var = :X          # we will plot X vs S</code></pre><p>When creating a bifurcation diagram, we typically start at some point in parameter-space. We will simply select the beginning of the interval over which we wish to compute the bifurcation diagram, <code>p_span[1]</code>. We thus create a modified parameter set where <code>S = 0.1</code>. For this parameter set, we also guess the steady state of the system. While a good estimate could be provided through an ODE simulation, BifurcationKit does not require the guess to be very accurate.</p><pre><code class="language-julia hljs">p_bstart = copy(p)
p_bstart[bif_par] = p_span[1]
u0 = [:X =&gt; 1.0, :A =&gt; 1.0]</code></pre><p>Finally, we extract the ODE derivative function and its jacobian in a form that BifurcationKit can use:</p><pre><code class="language- hljs">oprob = ODEProblem(rn, u0, (0.0, 0.0), p_bstart; jac = true)
F = (u,p) -&gt; oprob.f(u, p, 0)
J = (u,p) -&gt; oprob.f.jac(u, p, 0)
nothing   # hide</code></pre><p>In creating an <code>ODEProblem</code> an ordering is chosen for the initial condition and parameters, and regular <code>Float64</code> vectors of their numerical values are created as <code>oprob.u0</code> and <code>oprob.p</code> respectively. BifurcationKit needs to know the index in <code>oprob.p</code> of our bifurcation parameter, <code>:S</code>, and the index in <code>oprob.u0</code> of the variable we wish to plot, <code>:X</code>. We calculate these as</p><pre><code class="language-julia hljs"># get S and X as symbolic variables
@unpack S, X = rn

# find their indices in oprob.p and oprob.u0 respectively
bif_idx  = findfirst(isequal(S), parameters(rn))
plot_idx = findfirst(isequal(X), species(rn))</code></pre><p>Now, we load the required packages to create and plot the bifurcation diagram. We also bundle the information we have compiled so far into a <code>BifurcationProblem</code>.</p><pre><code class="language- hljs">using BifurcationKit, Plots, LinearAlgebra, Setfield

bprob = BifurcationProblem(F, oprob.u0, oprob.p, (@lens _[bif_idx]);
                           recordFromSolution = (x, p) -&gt; x[plot_idx], J = J)
nothing   # hide</code></pre><p>Next, we need to specify the input options for the pseudo-arclength continuation method (PACM) which produces the diagram.</p><pre><code class="language-julia hljs">bopts = ContinuationPar(dsmax = 0.05,          # Max arclength in PACM.
                        dsmin = 1e-4,          # Min arclength in PACM.
                        ds = 0.001,            # Initial (positive) arclength in PACM.
                        maxSteps = 100000,     # Max number of steps.
                        pMin = p_span[1],      # Min p-val (if hit, the method stops).
                        pMax = p_span[2],      # Max p-val (if hit, the method stops).
                        detectBifurcation = 3) # Value in {0,1,2,3}</code></pre><p>Here <code>detectBifurcation</code> determines to what extent bifurcation points are detected and how accurately their values are determined. Three indicates to use the most accurate method for calculating their values.</p><p>We are now ready to compute the bifurcation diagram:</p><pre><code class="language- hljs">bf = bifurcationdiagram(bprob, PALC(), 2, (args...) -&gt; bopts)
nothing   # hide</code></pre><p>Finally, we can plot it:</p><pre><code class="language- hljs">plot(bf; xlabel = string(bif_par), ylabel = string(plot_var))</code></pre><p>Here, the Hopf bifurcation is marked with a red dot and the fold bifurcations with blue dots. The region with a thinner line width corresponds to unstable steady states.</p><p>This tutorial demonstrated how to make a simple bifurcation diagram where all branches are connected. However, BifurcationKit.jl is a very powerful package capable of a lot more. For more details, please see that package&#39;s documentation: <a href="https://bifurcationkit.github.io/BifurcationKitDocs.jl/stable/">BifurcationKit.jl</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../homotopy_continuation/">« Finding Steady States through Homotopy Continuation</a><a class="docs-footer-nextpage" href="../parameter_estimation/">Parameter Estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 17 September 2023 22:36">Sunday 17 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
