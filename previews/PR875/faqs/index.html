<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>FAQs · Catalyst.jl</title><meta name="title" content="FAQs · Catalyst.jl"/><meta property="og:title" content="FAQs · Catalyst.jl"/><meta property="twitter:title" content="FAQs · Catalyst.jl"/><meta name="description" content="Documentation for Catalyst.jl."/><meta property="og:description" content="Documentation for Catalyst.jl."/><meta property="twitter:description" content="Documentation for Catalyst.jl."/><meta property="og:url" content="https://docs.sciml.ai/Catalyst/stable/faqs/"/><meta property="twitter:url" content="https://docs.sciml.ai/Catalyst/stable/faqs/"/><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/faqs/"/><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../home/"><img src="../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../home/">Catalyst.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../home/">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Model Creation and Properties</span><ul><li><a class="tocitem" href="../model_creation/dsl_description/">The Reaction DSL</a></li><li><a class="tocitem" href="../model_creation/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../model_creation/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../model_creation/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../model_creation/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../model_creation/network_analysis/">Network Analysis in Catalyst</a></li><li><a class="tocitem" href="../model_creation/chemistry_related_functionality/">Chemistry-related functionality</a></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../model_creation/examples/basic_CRN_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../model_creation/examples/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../model_creation/examples/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Model simulation</span><ul><li><a class="tocitem" href="../model_simulation/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../model_simulation/TOBEREMOVED_advanced_simulations/">Advanced Simulation Options</a></li></ul></li><li><span class="tocitem">Steady state analysis</span><ul><li><a class="tocitem" href="../steady_state_functionality/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../steady_state_functionality/nonlinear_solve/">Finding Steady States using NonlinearSolve.jl</a></li><li><a class="tocitem" href="../steady_state_functionality/steady_state_stability_computation/">Steady state stability computation</a></li><li><a class="tocitem" href="../steady_state_functionality/bifurcation_diagrams/">Bifurcation Diagrams</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../inverse_problems/optimization_ode_param_fitting/">Parameter Fitting for ODEs using SciML/Optimization.jl and DiffEqParamEstim.jl</a></li><li><a class="tocitem" href="../inverse_problems/structural_identifiability/">Structural Identifiability Analysis</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Inverse problem examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../inverse_problems/examples/ode_fitting_oscillation/">Fitting Parameters for an Oscillatory System</a></li></ul></li></ul></li><li><span class="tocitem">Spatial modelling</span></li><li class="is-active"><a class="tocitem" href>FAQs</a><ul class="internal"><li><a class="tocitem" href="#How-to-index-solution-objects-using-symbolic-variables-and-observables?"><span>How to index solution objects using symbolic variables and observables?</span></a></li><li><a class="tocitem" href="#How-to-disable-rescaling-of-reaction-rates-in-rate-laws?"><span>How to disable rescaling of reaction rates in rate laws?</span></a></li><li><a class="tocitem" href="#How-to-use-non-integer-stoichiometric-coefficients?"><span>How to use non-integer stoichiometric coefficients?</span></a></li><li><a class="tocitem" href="#How-to-set-default-values-for-initial-conditions-and-parameters?"><span>How to set default values for initial conditions and parameters?</span></a></li><li><a class="tocitem" href="#How-to-specify-initial-conditions-and-parameters-values-for-ODEProblem-and-other-problem-types?"><span>How to specify initial conditions and parameters values for <code>ODEProblem</code> and other problem types?</span></a></li><li><a class="tocitem" href="#How-to-include-non-reaction-terms-in-equations-for-a-chemical-species?"><span>How to include non-reaction terms in equations for a chemical species?</span></a></li><li><a class="tocitem" href="#How-to-modify-generated-ODEs?"><span>How to modify generated ODEs?</span></a></li><li><a class="tocitem" href="#How-to-override-mass-action-kinetics-rate-laws?"><span>How to override mass action kinetics rate laws?</span></a></li><li><a class="tocitem" href="#user_functions"><span>How to specify user-defined functions as reaction rates?</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>FAQs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>FAQs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/faqs.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="FAQs"><a class="docs-heading-anchor" href="#FAQs">FAQs</a><a id="FAQs-1"></a><a class="docs-heading-anchor-permalink" href="#FAQs" title="Permalink"></a></h1><h2 id="How-to-index-solution-objects-using-symbolic-variables-and-observables?"><a class="docs-heading-anchor" href="#How-to-index-solution-objects-using-symbolic-variables-and-observables?">How to index solution objects using symbolic variables and observables?</a><a id="How-to-index-solution-objects-using-symbolic-variables-and-observables?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-index-solution-objects-using-symbolic-variables-and-observables?" title="Permalink"></a></h2><p>One can directly use symbolic variables to index into SciML solution objects. Moreover, observables can also be evaluated in this way. For example, consider the system</p><pre><code class="language-julia hljs">using Catalyst, DifferentialEquations, Plots
rn = @reaction_network ABtoC begin
  (k₊,k₋), A + B &lt;--&gt; C
end

# initial condition and parameter values
setdefaults!(rn, [:A =&gt; 1.0, :B =&gt; 2.0, :C =&gt; 0.0, :k₊ =&gt; 1.0, :k₋ =&gt; 1.0])</code></pre><p>Let&#39;s convert it to a system of ODEs, using the conservation laws of the system to eliminate two of the species:</p><pre><code class="language-julia hljs">osys = convert(ODESystem, rn; remove_conserved = true)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} A\left( t \right)}{\mathrm{d}t} =&amp; k_- \left(  - A\left( t \right) + \Gamma_2 \right) - k_+ \left( A\left( t \right) + \Gamma_1 \right) A\left( t \right)
\end{align}
 \]</p><p>Notice the resulting ODE system has just one ODE, while algebraic observables have been added for the two removed species (in terms of the conservation law constants, <code>Γ[1]</code> and <code>Γ[2]</code>)</p><pre><code class="language-julia hljs">observed(osys)</code></pre><p class="math-container">\[ \begin{align}
B\left( t \right) =&amp; A\left( t \right) + \Gamma_1 \\
C\left( t \right) =&amp;  - A\left( t \right) + \Gamma_2
\end{align}
 \]</p><p>Let&#39;s solve the system and see how to index the solution using our symbolic variables</p><pre><code class="language- hljs">oprob = ODEProblem(osys, [], (0.0, 10.0), [])
sol = solve(oprob, Tsit5())</code></pre><p>Suppose we want to plot just species <code>C</code>, without having to know its integer index in the unknown vector. We can do this using the symbolic variable <code>C</code>, which we can get at in several ways</p><pre><code class="language- hljs">sol[osys.C]</code></pre><p>or</p><pre><code class="language- hljs">@unpack C = osys
sol[C]</code></pre><p>To evaluate <code>C</code> at specific times and plot it we can just do</p><pre><code class="language- hljs">t = range(0.0, 10.0, length=101)
plot(t, sol(t, idxs = C), label = &quot;C(t)&quot;, xlabel = &quot;t&quot;)</code></pre><p>If we want to get multiple variables we can just do</p><pre><code class="language- hljs">@unpack A, B = osys
sol(t, idxs = [A, B])</code></pre><p>Plotting multiple variables using the SciML plot recipe can be achieved like</p><pre><code class="language- hljs">plot(sol; idxs = [A, B])</code></pre><h2 id="How-to-disable-rescaling-of-reaction-rates-in-rate-laws?"><a class="docs-heading-anchor" href="#How-to-disable-rescaling-of-reaction-rates-in-rate-laws?">How to disable rescaling of reaction rates in rate laws?</a><a id="How-to-disable-rescaling-of-reaction-rates-in-rate-laws?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-disable-rescaling-of-reaction-rates-in-rate-laws?" title="Permalink"></a></h2><p>As explained in the <a href="../introduction_to_catalyst/introduction_to_catalyst/#Reaction-rate-laws-used-in-simulations">Reaction rate laws used in simulations</a> section, for a reaction such as <code>k, 2X --&gt; 0</code>, the generated rate law will rescale the rate constant, giving <code>k*X^2/2</code> instead of <code>k*X^2</code> for ODEs and <code>k*X*(X-1)/2</code> instead of <code>k*X*(X-1)</code> for jumps. This can be disabled when directly <code>convert</code>ing a <a href="../api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>. If <code>rn</code> is a generated <a href="../api/#Catalyst.ReactionSystem"><code>ReactionSystem</code></a>, we can do</p><pre><code class="language-julia hljs">osys = convert(ODESystem, rn; combinatoric_ratelaws=false)</code></pre><p>Disabling these rescalings should work for all conversions of <code>ReactionSystem</code>s to other <code>ModelingToolkit.AbstractSystem</code>s.</p><h2 id="How-to-use-non-integer-stoichiometric-coefficients?"><a class="docs-heading-anchor" href="#How-to-use-non-integer-stoichiometric-coefficients?">How to use non-integer stoichiometric coefficients?</a><a id="How-to-use-non-integer-stoichiometric-coefficients?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-use-non-integer-stoichiometric-coefficients?" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Catalyst
rn = @reaction_network begin
  k, 2.5*A --&gt; 3*B
end</code></pre><p class="math-container">\[ \begin{align*}
2.5 \mathrm{A} &amp;\xrightarrow{k} 3.0 \mathrm{B}  
 \end{align*}
 \]</p><p>or directly via</p><pre><code class="language- hljs">t = default_t()
@parameters k b
@species A(t) B(t) C(t) D(t)
rx1 = Reaction(k,[B,C],[B,D], [2.5,1],[3.5, 2.5])
rx2 = Reaction(2*k, [B], [D], [1], [2.5])
rx3 = Reaction(2*k, [B], [D], [2.5], [2])
@named mixedsys = ReactionSystem([rx1, rx2, rx3], t, [A, B, C, D], [k, b])
osys = convert(ODESystem, mixedsys; combinatoric_ratelaws = false)</code></pre><p>Note, when using <code>convert(ODESystem, mixedsys; combinatoric_ratelaws=false)</code> the <code>combinatoric_ratelaws=false</code> parameter must be passed. This is also true when calling <code>ODEProblem(mixedsys,...; combinatoric_ratelaws=false)</code>. As described above, this disables Catalyst&#39;s standard rescaling of reaction rates when generating reaction rate laws, see also the <a href="../introduction_to_catalyst/introduction_to_catalyst/#Reaction-rate-laws-used-in-simulations">Reaction rate laws used in simulations</a> section. Leaving this keyword out for systems with floating point stoichiometry will give an error message.</p><p>For a more extensive documentation of using non-integer stoichiometric coefficients, please see the <a href="../model_creation/parametric_stoichiometry/#parametric_stoichiometry">Symbolic Stochiometries</a> section.</p><h2 id="How-to-set-default-values-for-initial-conditions-and-parameters?"><a class="docs-heading-anchor" href="#How-to-set-default-values-for-initial-conditions-and-parameters?">How to set default values for initial conditions and parameters?</a><a id="How-to-set-default-values-for-initial-conditions-and-parameters?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-set-default-values-for-initial-conditions-and-parameters?" title="Permalink"></a></h2><p>How to set defaults when using the <code>@reaction_network</code> macro is described in more detail <a href="../model_creation/dsl_description/#dsl_description_defaults">here</a>. There are several ways to do this. Using the DSL, one can use the <code>@species</code> and <code>@parameters</code> options:</p><pre><code class="language-julia hljs">using Catalyst
sir = @reaction_network sir begin
    @species S(t)=999.0 I(t)=1.0 R(t)=0.0
    @parameters β=1e-4 ν=0.01
    β, S + I --&gt; 2I
    ν, I --&gt; R
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Model sir
Unknowns (3):
  S(t) [defaults to 999.0]
  I(t) [defaults to 1.0]
  R(t) [defaults to 0.0]
Parameters (2):
  β [defaults to 0.0001]
  ν [defaults to 0.01]</code></pre><p>When directly constructing a <code>ReactionSystem</code>, we can set the symbolic values to have the desired default values, and this will automatically be propagated through to the equation solvers:</p><pre><code class="language- hljs">using Catalyst, Plots, OrdinaryDiffEq
t = default_t()
@parameters β=1e-4 ν=.01
@species S(t)=999.0 I(t)=1.0 R(t)=0.0
rx1 = Reaction(β, [S, I], [I], [1,1], [2])
rx2 = Reaction(ν, [I], [R])
@named sir = ReactionSystem([rx1, rx2], t)
oprob = ODEProblem(sir, [], (0.0, 250.0))
sol = solve(oprob, Tsit5())
plot(sol)</code></pre><p>One can also build a mapping from symbolic parameter/species to value/initial condition and pass these to the <code>ReactionSystem</code> via the <code>defaults</code> keyword argument:</p><pre><code class="language-julia hljs">@parameters β ν
@species S(t) I(t) R(t)
rx1 = Reaction(β, [S,I], [I], [1,1], [2])
rx2 = Reaction(ν, [I], [R])
defs = [β =&gt; 1e-4, ν =&gt; .01, S =&gt; 999.0, I =&gt; 1.0, R =&gt; 0.0]
@named sir = ReactionSystem([rx1, rx2], t; defaults = defs)</code></pre><p>Finally, default values can also be added after creating the system via the <code>setdefaults!</code> command and passing a <code>Symbol</code> based mapping, like</p><pre><code class="language-julia hljs">sir = @reaction_network sir begin
    β, S + I --&gt; 2I
    ν, I --&gt; R
end
setdefaults!(sir, [:β =&gt; 1e-4, :ν =&gt; .01, :S =&gt; 999.0, :I =&gt; 1.0, :R =&gt; 0.0])</code></pre><h2 id="How-to-specify-initial-conditions-and-parameters-values-for-ODEProblem-and-other-problem-types?"><a class="docs-heading-anchor" href="#How-to-specify-initial-conditions-and-parameters-values-for-ODEProblem-and-other-problem-types?">How to specify initial conditions and parameters values for <code>ODEProblem</code> and other problem types?</a><a id="How-to-specify-initial-conditions-and-parameters-values-for-ODEProblem-and-other-problem-types?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-specify-initial-conditions-and-parameters-values-for-ODEProblem-and-other-problem-types?" title="Permalink"></a></h2><p>To explicitly pass initial conditions and parameters we can use mappings from Julia <code>Symbol</code>s corresponding to each variable/parameter to their values, or from ModelingToolkit symbolic variables/parameters to their values. Using <code>Symbol</code>s we have</p><pre><code class="language-julia hljs">using Catalyst, DifferentialEquations
rn = @reaction_network begin
    α, S + I --&gt; 2I
    β, I --&gt; R
end
u0 = [:S =&gt; 999.0, :I =&gt; 1.0, :R =&gt; 0.0]
p  = (:α =&gt; 1e-4, :β =&gt; .01)
op1  = ODEProblem(rn, u0, (0.0, 250.0), p)</code></pre><p>while using ModelingToolkit symbolic variables we have</p><pre><code class="language-julia hljs">t = default_t()
@parameters α β
@species S(t) I(t) R(t)
u0 = [S =&gt; 999.0, I =&gt; 1.0, R =&gt; 0.0]
p  = (α =&gt; 1e-4, β =&gt; .01)
op2  = ODEProblem(rn, u0, (0.0, 250.0), p)</code></pre><p><em>Note,</em> while symbolic mappings as in the last example will work with <em>any</em> <code>ModelingToolkit.AbstractSystem</code>, for example if one <code>convert</code>s <code>rn</code> to an <code>ODESystem</code>, <code>Symbol</code>-based mappings only work when passing a <code>ReactionSystem</code> directly into a problem type. That is, the following does not work</p><pre><code class="language- hljs">osys = convert(ODESystem, rn)

# this fails
u0 = [:S =&gt; 999.0, :I =&gt; 1.0, :R =&gt; 0.0]
p  = (:α =&gt; 1e-4, :β =&gt; .01)
op  = ODEProblem(osys, u0, (0.0, 250.0), p)</code></pre><p>In this case one must either use a symbolic mapping as was used to make <code>op2</code> in the second example, or one can use the <code>symmap_to_varmap</code> function to convert the <code>Symbol</code> mapping to a symbolic mapping. I.e. this works</p><pre><code class="language- hljs">osys = convert(ODESystem, rn)

# this works
u0 = symmap_to_varmap(rn, [:S =&gt; 999.0, :I =&gt; 1.0, :R =&gt; 0.0])
p  = symmap_to_varmap(rn, (:α =&gt; 1e-4, :β =&gt; .01))
op  = ODEProblem(osys, u0, (0.0, 250.0), p)
nothing # hide</code></pre><h2 id="How-to-include-non-reaction-terms-in-equations-for-a-chemical-species?"><a class="docs-heading-anchor" href="#How-to-include-non-reaction-terms-in-equations-for-a-chemical-species?">How to include non-reaction terms in equations for a chemical species?</a><a id="How-to-include-non-reaction-terms-in-equations-for-a-chemical-species?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-include-non-reaction-terms-in-equations-for-a-chemical-species?" title="Permalink"></a></h2><p>One method to add non-reaction terms into an ODE or algebraic equation for a chemical species is to add a new (non-species) unknown variable that represents those terms, let it be the rate of zero order reaction, and add a constraint equation. I.e., to add a force of <code>(1 + sin(t))</code> to <span>$dA/dt$</span> in a system with the reaction <code>k, A --&gt; 0</code>, we can do</p><pre><code class="language- hljs">using Catalyst
t = default_t()
@variables f(t)
rx1 = @reaction k, A --&gt; 0
rx2 = @reaction $f, 0 --&gt; A
eq = f ~ (1 + sin(t))
@named rs = ReactionSystem([rx1, rx2, eq], t)
osys = convert(ODESystem, rs)</code></pre><p>In the final ODE model, <code>f</code> can be eliminated by using <code>ModelingToolkit.structural_simplify</code></p><pre><code class="language- hljs">osyss = structural_simplify(osys)
full_equations(osyss)</code></pre><h2 id="How-to-modify-generated-ODEs?"><a class="docs-heading-anchor" href="#How-to-modify-generated-ODEs?">How to modify generated ODEs?</a><a id="How-to-modify-generated-ODEs?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-modify-generated-ODEs?" title="Permalink"></a></h2><p>Conversion to other <code>ModelingToolkit.AbstractSystem</code>s allows the possibility to modify the system with further terms that are difficult to encode as a chemical reaction or a constraint equation. For example, an alternative method to the previous question for adding a forcing function, <span>$1 + \sin(t)$</span>, to the ODE for <code>dA/dt</code> is</p><pre><code class="language-julia hljs">using Catalyst
rn = @reaction_network begin
    k, A --&gt; 0
end
osys = convert(ODESystem, rn)
dAdteq = equations(osys)[1]
t      = ModelingToolkit.get_iv(osys)
dAdteq = Equation(dAdteq.lhs, dAdteq.rhs + 1 + sin(t))

# create a new ODESystem with the modified equation
@named osys2  = ODESystem([dAdteq], t)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} A\left( t \right)}{\mathrm{d}t} =&amp; 1 + \sin\left( t \right) - k A\left( t \right)
\end{align}
 \]</p><h2 id="How-to-override-mass-action-kinetics-rate-laws?"><a class="docs-heading-anchor" href="#How-to-override-mass-action-kinetics-rate-laws?">How to override mass action kinetics rate laws?</a><a id="How-to-override-mass-action-kinetics-rate-laws?-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-override-mass-action-kinetics-rate-laws?" title="Permalink"></a></h2><p>While generally one wants the reaction rate law to use the law of mass action, so the reaction</p><pre><code class="language-julia hljs">using Catalyst
rn = @reaction_network begin
  k, X --&gt; ∅
end
convert(ODESystem, rn)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} X\left( t \right)}{\mathrm{d}t} =&amp;  - k X\left( t \right)
\end{align}
 \]</p><p>occurs at the (ODE) rate <span>$d[X]/dt = -k[X]$</span>, it is possible to override this by using any of the following non-filled arrows when declaring the reaction: <code>&lt;=</code>, <code>⇐</code>, <code>⟽</code>, <code>=&gt;</code>, <code>⇒</code>, <code>⟾</code>, <code>⇔</code>, <code>⟺</code>. This means that the reaction</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  k, X =&gt; ∅
end
convert(ODESystem, rn)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} X\left( t \right)}{\mathrm{d}t} =&amp;  - k
\end{align}
 \]</p><p>will occur at rate <span>$d[X]/dt = -k$</span> (which might become a problem since <span>$[X]$</span> will be degraded at a constant rate even when very small or equal to 0).</p><p>Note, stoichiometric coefficients are still included, i.e. the reaction</p><pre><code class="language-julia hljs">rn = @reaction_network begin
  k, 2*X ⇒ ∅
end
convert(ODESystem, rn)</code></pre><p class="math-container">\[ \begin{align}
\frac{\mathrm{d} X\left( t \right)}{\mathrm{d}t} =&amp;  - 2 k
\end{align}
 \]</p><p>has rate <span>$d[X]/dt = -2 k$</span>.</p><h2 id="user_functions"><a class="docs-heading-anchor" href="#user_functions">How to specify user-defined functions as reaction rates?</a><a id="user_functions-1"></a><a class="docs-heading-anchor-permalink" href="#user_functions" title="Permalink"></a></h2><p>The reaction network DSL can &quot;see&quot; user-defined functions that work with ModelingToolkit. e.g., this is should work</p><pre><code class="language-julia hljs">using Catalyst
myHill(x) = 2*x^3/(x^3+1.5^3)
rn = @reaction_network begin
  myHill(X), ∅ --&gt; X
end</code></pre><p class="math-container">\[ \begin{align*}
\varnothing &amp;\xrightarrow{\frac{2 X^{3}}{3.375 + X^{3}}} \mathrm{X}  
 \end{align*}
 \]</p><p>In some cases, it may be necessary or desirable to register functions with Symbolics.jl before their use in Catalyst, see the discussion <a href="https://symbolics.juliasymbolics.org/stable/manual/functions/">here</a>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../inverse_problems/examples/ode_fitting_oscillation/">« Fitting Parameters for an Oscillatory System</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Friday 24 May 2024 20:04">Friday 24 May 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
