<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parameter Fitting for ODEs using PEtab.jl · Catalyst.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-90474609-3"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-90474609-3', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.sciml.ai/Catalyst/stable/inverse_problems/petab_ode_param_fitting/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Catalyst.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Catalyst.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Introduction to Catalyst</span><ul><li><a class="tocitem" href="../../introduction_to_catalyst/catalyst_for_new_julia_users/">Introduction to Catalyst and Julia for New Julia users</a></li><li><a class="tocitem" href="../../introduction_to_catalyst/introduction_to_catalyst/">Introduction to Catalyst</a></li></ul></li><li><span class="tocitem">Catalyst Functionality</span><ul><li><a class="tocitem" href="../../catalyst_functionality/dsl_description/">The Reaction DSL</a></li><li><a class="tocitem" href="../../catalyst_functionality/programmatic_CRN_construction/">Programmatic Construction of Symbolic Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/compositional_modeling/">Compositional Modeling of Reaction Systems</a></li><li><a class="tocitem" href="../../catalyst_functionality/constraint_equations/">Constraint Equations and Events</a></li><li><a class="tocitem" href="../../catalyst_functionality/parametric_stoichiometry/">Symbolic Stochiometries</a></li><li><a class="tocitem" href="../../catalyst_functionality/network_analysis/">Network Analysis in Catalyst</a></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Model creation examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../catalyst_functionality/example_networks/basic_CRN_examples/">Basic Chemical Reaction Network Examples</a></li><li><a class="tocitem" href="../../catalyst_functionality/example_networks/hodgkin_huxley_equation/">Hodgkin-Huxley Equation</a></li><li><a class="tocitem" href="../../catalyst_functionality/example_networks/smoluchowski_coagulation_equation/">Smoluchowski Coagulation Equation</a></li></ul></li></ul></li><li><span class="tocitem">Catalyst Applications</span><ul><li><a class="tocitem" href="../../catalyst_applications/simulation_structure_interfacing/">Interfacing problems, integrators, and solutions</a></li><li><a class="tocitem" href="../../catalyst_applications/advanced_simulations/">Advanced Simulation Options</a></li><li><a class="tocitem" href="../../catalyst_applications/homotopy_continuation/">Finding Steady States through Homotopy Continuation</a></li><li><a class="tocitem" href="../../catalyst_applications/bifurcation_diagrams/">Bifurcation Diagrams</a></li></ul></li><li><span class="tocitem">Inverse Problems</span><ul><li><a class="tocitem" href="../parameter_estimation/">Parameter Estimation</a></li><li class="is-active"><a class="tocitem" href>Parameter Fitting for ODEs using PEtab.jl</a><ul class="internal"><li><a class="tocitem" href="#Introductory-example"><span>Introductory example</span></a></li><li><a class="tocitem" href="#petab_observables"><span>Additional features: Observables</span></a></li><li><a class="tocitem" href="#petab_parameters"><span>Additional features: Parameters</span></a></li><li><a class="tocitem" href="#petab_simulation_conditions"><span>Simulation conditions</span></a></li><li><a class="tocitem" href="#petab_simulation_initial_conditions"><span>Additional features: Initial conditions</span></a></li><li><a class="tocitem" href="#petab_simulation_options"><span>Additional features: Simulation options</span></a></li><li><a class="tocitem" href="#petab_optimisation"><span>Additional features: Optimisation</span></a></li><li><a class="tocitem" href="#Objective-function-extraction"><span>Objective function extraction</span></a></li><li><a class="tocitem" href="#petab_multistart_optimisation"><span>Multi-start optimisation</span></a></li><li><a class="tocitem" href="#petab_events"><span>Events</span></a></li><li><a class="tocitem" href="#petab_plotting"><span>Plot recipes</span></a></li><li><a class="tocitem" href="#petab_citations"><span>Citations</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../faqs/">FAQs</a></li><li><a class="tocitem" href="../../api/catalyst_api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Inverse Problems</a></li><li class="is-active"><a href>Parameter Fitting for ODEs using PEtab.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parameter Fitting for ODEs using PEtab.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/Catalyst.jl/blob/master/docs/src/inverse_problems/petab_ode_param_fitting.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="petab_parameter_fitting"><a class="docs-heading-anchor" href="#petab_parameter_fitting">Parameter Fitting for ODEs using PEtab.jl</a><a id="petab_parameter_fitting-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameter_fitting" title="Permalink"></a></h1><p>The <a href="https://github.com/sebapersson/PEtab.jl">PEtab.jl package</a> implements the <a href="https://petab.readthedocs.io/en/latest/">PEtab format</a> for fitting the parameters of deterministic CRN models to data (<a href="#petab_citations">please cite the corresponding papers if you use the PEtab approach in your research</a>)<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. PEtab.jl both implements methods for creating cost functions (determining how well parameter sets fit to data), and for minimizing these cost functions. The PEtab approach covers most cases of fitting deterministic (ODE) models to data. When possible, it is recommended to use it for parameter fitting (when not, an alternative, more general, approach will have to be used). This page describes how to combine PEtab.jl and Catalyst for parameter fitting, with the PEtab.jl package providing <a href="https://sebapersson.github.io/PEtab.jl/stable/">a more extensive documentation</a> (this tutorial is partially an adaptation of this documentation).</p><h2 id="Introductory-example"><a class="docs-heading-anchor" href="#Introductory-example">Introductory example</a><a id="Introductory-example-1"></a><a class="docs-heading-anchor-permalink" href="#Introductory-example" title="Permalink"></a></h2><p>Let us consider a simple catalysis network, where an enzyme (<em>E</em>) turns a substrate (<em>S</em>) into a product (<em>P</em>):</p><pre><code class="language-julia hljs">using Catalyst, PEtab

rn = @reaction_network begin
    kB, S + E --&gt; SE
    kD, SE --&gt; S + E
    kP, SE --&gt; P + E
end</code></pre><p class="math-container">\[ \begin{align*}
\mathrm{S} + \mathrm{E} &amp;\xrightleftharpoons[kD]{kB} \mathrm{SE} \\
\mathrm{SE} &amp;\xrightarrow{kP} \mathrm{P} + \mathrm{E}  
 \end{align*}
 \]</p><p>From some known initial condition, and a true parameter set (which we later want to recover from the data) we generate synthetic data (on which we will demonstrate the fitting process).</p><pre><code class="language-julia hljs"># Define initial conditions and parameters.
u0 = [:S =&gt; 1.0, :E =&gt; 1.0, :SE =&gt; 0.0, :P =&gt; 0.0]
p_true = [:kB =&gt; 1.0, :kD =&gt; 0.1, :kP =&gt; 0.5]

# Generate synthetic data.
using OrdinaryDiffEq, Random
oprob = ODEProblem(rn, u0, (0.0, 10.0), p_true)
sol = solve(oprob, Tsit5(); saveat=0.1)
data = (0.8 .+ 0.4*rand(10)) .* sol[:P][10:10:end]

# Plots the true solutions and the (synthetic data) measurements.
using Plots
plot(sol; idxs=:P, label=&quot;True solution&quot;)
plot!(sol.t[10:10:end], data; label=&quot;Measurements&quot;, seriestype=:scatter)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="400" viewBox="0 0 3200 1600">
<defs>
  <clipPath id="clip250">
    <rect x="0" y="0" width="3200" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip250)" d="M0 1600 L3200 1600 L3200 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip251">
    <rect x="640" y="0" width="2241" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip250)" d="M194.274 1443.7 L3152.76 1443.7 L3152.76 47.2441 L194.274 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip252">
    <rect x="194" y="47" width="2959" height="1397"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1443.7 194.274,47.2441 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="785.97,1443.7 785.97,47.2441 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1377.67,1443.7 1377.67,47.2441 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1969.36,1443.7 1969.36,47.2441 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2561.06,1443.7 2561.06,47.2441 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="3152.76,1443.7 3152.76,47.2441 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 3152.76,1443.7 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,47.2441 3152.76,47.2441 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 194.274,1424.8 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="785.97,1443.7 785.97,1424.8 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1377.67,1443.7 1377.67,1424.8 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1969.36,1443.7 1969.36,1424.8 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2561.06,1443.7 2561.06,1424.8 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="3152.76,1443.7 3152.76,1424.8 "/>
<path clip-path="url(#clip250)" d="M194.274 1481.02 Q190.663 1481.02 188.834 1484.58 Q187.029 1488.12 187.029 1495.25 Q187.029 1502.36 188.834 1505.93 Q190.663 1509.47 194.274 1509.47 Q197.908 1509.47 199.714 1505.93 Q201.542 1502.36 201.542 1495.25 Q201.542 1488.12 199.714 1484.58 Q197.908 1481.02 194.274 1481.02 M194.274 1477.31 Q200.084 1477.31 203.14 1481.92 Q206.218 1486.5 206.218 1495.25 Q206.218 1503.98 203.14 1508.59 Q200.084 1513.17 194.274 1513.17 Q188.464 1513.17 185.385 1508.59 Q182.33 1503.98 182.33 1495.25 Q182.33 1486.5 185.385 1481.92 Q188.464 1477.31 194.274 1477.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M780.623 1508.56 L796.943 1508.56 L796.943 1512.5 L774.998 1512.5 L774.998 1508.56 Q777.66 1505.81 782.244 1501.18 Q786.85 1496.53 788.031 1495.19 Q790.276 1492.66 791.156 1490.93 Q792.058 1489.17 792.058 1487.48 Q792.058 1484.72 790.114 1482.99 Q788.193 1481.25 785.091 1481.25 Q782.892 1481.25 780.438 1482.01 Q778.007 1482.78 775.23 1484.33 L775.23 1479.61 Q778.054 1478.47 780.507 1477.89 Q782.961 1477.31 784.998 1477.31 Q790.369 1477.31 793.563 1480 Q796.757 1482.69 796.757 1487.18 Q796.757 1489.31 795.947 1491.23 Q795.16 1493.12 793.054 1495.72 Q792.475 1496.39 789.373 1499.61 Q786.271 1502.8 780.623 1508.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M1380.68 1482.01 L1368.87 1500.46 L1380.68 1500.46 L1380.68 1482.01 M1379.45 1477.94 L1385.33 1477.94 L1385.33 1500.46 L1390.26 1500.46 L1390.26 1504.35 L1385.33 1504.35 L1385.33 1512.5 L1380.68 1512.5 L1380.68 1504.35 L1365.07 1504.35 L1365.07 1499.84 L1379.45 1477.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M1969.77 1493.36 Q1966.62 1493.36 1964.77 1495.51 Q1962.94 1497.66 1962.94 1501.41 Q1962.94 1505.14 1964.77 1507.31 Q1966.62 1509.47 1969.77 1509.47 Q1972.92 1509.47 1974.75 1507.31 Q1976.6 1505.14 1976.6 1501.41 Q1976.6 1497.66 1974.75 1495.51 Q1972.92 1493.36 1969.77 1493.36 M1979.05 1478.7 L1979.05 1482.96 Q1977.29 1482.13 1975.49 1481.69 Q1973.7 1481.25 1971.94 1481.25 Q1967.31 1481.25 1964.86 1484.37 Q1962.43 1487.5 1962.08 1493.82 Q1963.45 1491.81 1965.51 1490.74 Q1967.57 1489.65 1970.05 1489.65 Q1975.25 1489.65 1978.26 1492.82 Q1981.3 1495.97 1981.3 1501.41 Q1981.3 1506.74 1978.15 1509.95 Q1975 1513.17 1969.77 1513.17 Q1963.77 1513.17 1960.6 1508.59 Q1957.43 1503.98 1957.43 1495.25 Q1957.43 1487.06 1961.32 1482.2 Q1965.21 1477.31 1971.76 1477.31 Q1973.52 1477.31 1975.3 1477.66 Q1977.11 1478.01 1979.05 1478.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M2561.06 1496.09 Q2557.73 1496.09 2555.8 1497.87 Q2553.91 1499.65 2553.91 1502.78 Q2553.91 1505.9 2555.8 1507.69 Q2557.73 1509.47 2561.06 1509.47 Q2564.39 1509.47 2566.31 1507.69 Q2568.24 1505.88 2568.24 1502.78 Q2568.24 1499.65 2566.31 1497.87 Q2564.42 1496.09 2561.06 1496.09 M2556.38 1494.1 Q2553.37 1493.36 2551.68 1491.3 Q2550.02 1489.24 2550.02 1486.27 Q2550.02 1482.13 2552.96 1479.72 Q2555.92 1477.31 2561.06 1477.31 Q2566.22 1477.31 2569.16 1479.72 Q2572.1 1482.13 2572.1 1486.27 Q2572.1 1489.24 2570.41 1491.3 Q2568.74 1493.36 2565.76 1494.1 Q2569.14 1494.88 2571.01 1497.18 Q2572.91 1499.47 2572.91 1502.78 Q2572.91 1507.8 2569.83 1510.49 Q2566.78 1513.17 2561.06 1513.17 Q2555.34 1513.17 2552.26 1510.49 Q2549.21 1507.8 2549.21 1502.78 Q2549.21 1499.47 2551.11 1497.18 Q2553 1494.88 2556.38 1494.1 M2554.67 1486.71 Q2554.67 1489.4 2556.34 1490.9 Q2558.03 1492.41 2561.06 1492.41 Q2564.07 1492.41 2565.76 1490.9 Q2567.47 1489.4 2567.47 1486.71 Q2567.47 1484.03 2565.76 1482.52 Q2564.07 1481.02 2561.06 1481.02 Q2558.03 1481.02 2556.34 1482.52 Q2554.67 1484.03 2554.67 1486.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M3127.44 1508.56 L3135.08 1508.56 L3135.08 1482.2 L3126.77 1483.87 L3126.77 1479.61 L3135.04 1477.94 L3139.71 1477.94 L3139.71 1508.56 L3147.35 1508.56 L3147.35 1512.5 L3127.44 1512.5 L3127.44 1508.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M3166.8 1481.02 Q3163.18 1481.02 3161.36 1484.58 Q3159.55 1488.12 3159.55 1495.25 Q3159.55 1502.36 3161.36 1505.93 Q3163.18 1509.47 3166.8 1509.47 Q3170.43 1509.47 3172.23 1505.93 Q3174.06 1502.36 3174.06 1495.25 Q3174.06 1488.12 3172.23 1484.58 Q3170.43 1481.02 3166.8 1481.02 M3166.8 1477.31 Q3172.61 1477.31 3175.66 1481.92 Q3178.74 1486.5 3178.74 1495.25 Q3178.74 1503.98 3175.66 1508.59 Q3172.61 1513.17 3166.8 1513.17 Q3160.99 1513.17 3157.91 1508.59 Q3154.85 1503.98 3154.85 1495.25 Q3154.85 1486.5 3157.91 1481.92 Q3160.99 1477.31 3166.8 1477.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M1672.58 1554.79 L1672.58 1564.92 L1684.64 1564.92 L1684.64 1569.47 L1672.58 1569.47 L1672.58 1588.82 Q1672.58 1593.18 1673.75 1594.42 Q1674.96 1595.66 1678.62 1595.66 L1684.64 1595.66 L1684.64 1600.56 L1678.62 1600.56 Q1671.84 1600.56 1669.27 1598.05 Q1666.69 1595.5 1666.69 1588.82 L1666.69 1569.47 L1662.39 1569.47 L1662.39 1564.92 L1666.69 1564.92 L1666.69 1554.79 L1672.58 1554.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1404.18 3152.76,1404.18 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1092.42 3152.76,1092.42 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,780.656 3152.76,780.656 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,468.895 3152.76,468.895 "/>
<polyline clip-path="url(#clip252)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,157.135 3152.76,157.135 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 194.274,47.2441 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="3152.76,1443.7 3152.76,47.2441 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1404.18 213.172,1404.18 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1092.42 213.172,1092.42 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,780.656 213.172,780.656 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,468.895 213.172,468.895 "/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,157.135 213.172,157.135 "/>
<path clip-path="url(#clip250)" d="M58.9365 1389.98 Q55.3254 1389.98 53.4967 1393.54 Q51.6912 1397.08 51.6912 1404.21 Q51.6912 1411.32 53.4967 1414.88 Q55.3254 1418.43 58.9365 1418.43 Q62.5707 1418.43 64.3763 1414.88 Q66.205 1411.32 66.205 1404.21 Q66.205 1397.08 64.3763 1393.54 Q62.5707 1389.98 58.9365 1389.98 M58.9365 1386.27 Q64.7467 1386.27 67.8022 1390.88 Q70.8809 1395.46 70.8809 1404.21 Q70.8809 1412.94 67.8022 1417.55 Q64.7467 1422.13 58.9365 1422.13 Q53.1264 1422.13 50.0477 1417.55 Q46.9921 1412.94 46.9921 1404.21 Q46.9921 1395.46 50.0477 1390.88 Q53.1264 1386.27 58.9365 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M79.0984 1415.58 L83.9827 1415.58 L83.9827 1421.46 L79.0984 1421.46 L79.0984 1415.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M104.168 1389.98 Q100.557 1389.98 98.728 1393.54 Q96.9224 1397.08 96.9224 1404.21 Q96.9224 1411.32 98.728 1414.88 Q100.557 1418.43 104.168 1418.43 Q107.802 1418.43 109.608 1414.88 Q111.436 1411.32 111.436 1404.21 Q111.436 1397.08 109.608 1393.54 Q107.802 1389.98 104.168 1389.98 M104.168 1386.27 Q109.978 1386.27 113.033 1390.88 Q116.112 1395.46 116.112 1404.21 Q116.112 1412.94 113.033 1417.55 Q109.978 1422.13 104.168 1422.13 Q98.3576 1422.13 95.2789 1417.55 Q92.2234 1412.94 92.2234 1404.21 Q92.2234 1395.46 95.2789 1390.88 Q98.3576 1386.27 104.168 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M134.33 1389.98 Q130.719 1389.98 128.89 1393.54 Q127.084 1397.08 127.084 1404.21 Q127.084 1411.32 128.89 1414.88 Q130.719 1418.43 134.33 1418.43 Q137.964 1418.43 139.769 1414.88 Q141.598 1411.32 141.598 1404.21 Q141.598 1397.08 139.769 1393.54 Q137.964 1389.98 134.33 1389.98 M134.33 1386.27 Q140.14 1386.27 143.195 1390.88 Q146.274 1395.46 146.274 1404.21 Q146.274 1412.94 143.195 1417.55 Q140.14 1422.13 134.33 1422.13 Q128.519 1422.13 125.441 1417.55 Q122.385 1412.94 122.385 1404.21 Q122.385 1395.46 125.441 1390.88 Q128.519 1386.27 134.33 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M59.9319 1078.22 Q56.3208 1078.22 54.4921 1081.78 Q52.6865 1085.32 52.6865 1092.45 Q52.6865 1099.56 54.4921 1103.12 Q56.3208 1106.66 59.9319 1106.66 Q63.5661 1106.66 65.3717 1103.12 Q67.2004 1099.56 67.2004 1092.45 Q67.2004 1085.32 65.3717 1081.78 Q63.5661 1078.22 59.9319 1078.22 M59.9319 1074.51 Q65.742 1074.51 68.7976 1079.12 Q71.8763 1083.7 71.8763 1092.45 Q71.8763 1101.18 68.7976 1105.78 Q65.742 1110.37 59.9319 1110.37 Q54.1217 1110.37 51.043 1105.78 Q47.9875 1101.18 47.9875 1092.45 Q47.9875 1083.7 51.043 1079.12 Q54.1217 1074.51 59.9319 1074.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M80.0938 1103.82 L84.978 1103.82 L84.978 1109.7 L80.0938 1109.7 L80.0938 1103.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M99.1909 1105.76 L115.51 1105.76 L115.51 1109.7 L93.566 1109.7 L93.566 1105.76 Q96.228 1103.01 100.811 1098.38 Q105.418 1093.72 106.598 1092.38 Q108.844 1089.86 109.723 1088.12 Q110.626 1086.36 110.626 1084.67 Q110.626 1081.92 108.682 1080.18 Q106.76 1078.45 103.658 1078.45 Q101.459 1078.45 99.0057 1079.21 Q96.5752 1079.97 93.7974 1081.53 L93.7974 1076.8 Q96.6215 1075.67 99.0752 1075.09 Q101.529 1074.51 103.566 1074.51 Q108.936 1074.51 112.131 1077.2 Q115.325 1079.88 115.325 1084.37 Q115.325 1086.5 114.515 1088.42 Q113.728 1090.32 111.621 1092.91 Q111.043 1093.59 107.941 1096.8 Q104.839 1100 99.1909 1105.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M125.371 1075.14 L143.728 1075.14 L143.728 1079.07 L129.654 1079.07 L129.654 1087.54 Q130.672 1087.2 131.691 1087.03 Q132.709 1086.85 133.728 1086.85 Q139.515 1086.85 142.894 1090.02 Q146.274 1093.19 146.274 1098.61 Q146.274 1104.19 142.802 1107.29 Q139.33 1110.37 133.01 1110.37 Q130.834 1110.37 128.566 1110 Q126.32 1109.63 123.913 1108.89 L123.913 1104.19 Q125.996 1105.32 128.219 1105.88 Q130.441 1106.43 132.918 1106.43 Q136.922 1106.43 139.26 1104.33 Q141.598 1102.22 141.598 1098.61 Q141.598 1095 139.26 1092.89 Q136.922 1090.78 132.918 1090.78 Q131.043 1090.78 129.168 1091.2 Q127.316 1091.62 125.371 1092.5 L125.371 1075.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M58.9365 766.455 Q55.3254 766.455 53.4967 770.02 Q51.6912 773.561 51.6912 780.691 Q51.6912 787.797 53.4967 791.362 Q55.3254 794.904 58.9365 794.904 Q62.5707 794.904 64.3763 791.362 Q66.205 787.797 66.205 780.691 Q66.205 773.561 64.3763 770.02 Q62.5707 766.455 58.9365 766.455 M58.9365 762.751 Q64.7467 762.751 67.8022 767.358 Q70.8809 771.941 70.8809 780.691 Q70.8809 789.418 67.8022 794.024 Q64.7467 798.607 58.9365 798.607 Q53.1264 798.607 50.0477 794.024 Q46.9921 789.418 46.9921 780.691 Q46.9921 771.941 50.0477 767.358 Q53.1264 762.751 58.9365 762.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M79.0984 792.056 L83.9827 792.056 L83.9827 797.936 L79.0984 797.936 L79.0984 792.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M94.2141 763.376 L112.57 763.376 L112.57 767.311 L98.4965 767.311 L98.4965 775.783 Q99.515 775.436 100.534 775.274 Q101.552 775.089 102.571 775.089 Q108.358 775.089 111.737 778.26 Q115.117 781.432 115.117 786.848 Q115.117 792.427 111.645 795.529 Q108.172 798.607 101.853 798.607 Q99.677 798.607 97.4085 798.237 Q95.1632 797.867 92.7558 797.126 L92.7558 792.427 Q94.8391 793.561 97.0613 794.117 Q99.2835 794.672 101.76 794.672 Q105.765 794.672 108.103 792.566 Q110.441 790.459 110.441 786.848 Q110.441 783.237 108.103 781.131 Q105.765 779.024 101.76 779.024 Q99.8854 779.024 98.0104 779.441 Q96.1585 779.857 94.2141 780.737 L94.2141 763.376 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M134.33 766.455 Q130.719 766.455 128.89 770.02 Q127.084 773.561 127.084 780.691 Q127.084 787.797 128.89 791.362 Q130.719 794.904 134.33 794.904 Q137.964 794.904 139.769 791.362 Q141.598 787.797 141.598 780.691 Q141.598 773.561 139.769 770.02 Q137.964 766.455 134.33 766.455 M134.33 762.751 Q140.14 762.751 143.195 767.358 Q146.274 771.941 146.274 780.691 Q146.274 789.418 143.195 794.024 Q140.14 798.607 134.33 798.607 Q128.519 798.607 125.441 794.024 Q122.385 789.418 122.385 780.691 Q122.385 771.941 125.441 767.358 Q128.519 762.751 134.33 762.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M59.9319 454.694 Q56.3208 454.694 54.4921 458.259 Q52.6865 461.8 52.6865 468.93 Q52.6865 476.036 54.4921 479.601 Q56.3208 483.143 59.9319 483.143 Q63.5661 483.143 65.3717 479.601 Q67.2004 476.036 67.2004 468.93 Q67.2004 461.8 65.3717 458.259 Q63.5661 454.694 59.9319 454.694 M59.9319 450.99 Q65.742 450.99 68.7976 455.597 Q71.8763 460.18 71.8763 468.93 Q71.8763 477.657 68.7976 482.263 Q65.742 486.847 59.9319 486.847 Q54.1217 486.847 51.043 482.263 Q47.9875 477.657 47.9875 468.93 Q47.9875 460.18 51.043 455.597 Q54.1217 450.99 59.9319 450.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M80.0938 480.296 L84.978 480.296 L84.978 486.175 L80.0938 486.175 L80.0938 480.296 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M93.9826 451.615 L116.205 451.615 L116.205 453.606 L103.658 486.175 L98.7743 486.175 L110.58 455.55 L93.9826 455.55 L93.9826 451.615 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M125.371 451.615 L143.728 451.615 L143.728 455.55 L129.654 455.55 L129.654 464.023 Q130.672 463.675 131.691 463.513 Q132.709 463.328 133.728 463.328 Q139.515 463.328 142.894 466.5 Q146.274 469.671 146.274 475.087 Q146.274 480.666 142.802 483.768 Q139.33 486.847 133.01 486.847 Q130.834 486.847 128.566 486.476 Q126.32 486.106 123.913 485.365 L123.913 480.666 Q125.996 481.8 128.219 482.356 Q130.441 482.911 132.918 482.911 Q136.922 482.911 139.26 480.805 Q141.598 478.699 141.598 475.087 Q141.598 471.476 139.26 469.37 Q136.922 467.263 132.918 467.263 Q131.043 467.263 129.168 467.68 Q127.316 468.097 125.371 468.976 L125.371 451.615 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M49.7467 170.479 L57.3856 170.479 L57.3856 144.114 L49.0754 145.78 L49.0754 141.521 L57.3393 139.855 L62.0152 139.855 L62.0152 170.479 L69.654 170.479 L69.654 174.415 L49.7467 174.415 L49.7467 170.479 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M79.0984 168.535 L83.9827 168.535 L83.9827 174.415 L79.0984 174.415 L79.0984 168.535 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M104.168 142.933 Q100.557 142.933 98.728 146.498 Q96.9224 150.04 96.9224 157.169 Q96.9224 164.276 98.728 167.841 Q100.557 171.382 104.168 171.382 Q107.802 171.382 109.608 167.841 Q111.436 164.276 111.436 157.169 Q111.436 150.04 109.608 146.498 Q107.802 142.933 104.168 142.933 M104.168 139.23 Q109.978 139.23 113.033 143.836 Q116.112 148.419 116.112 157.169 Q116.112 165.896 113.033 170.503 Q109.978 175.086 104.168 175.086 Q98.3576 175.086 95.2789 170.503 Q92.2234 165.896 92.2234 157.169 Q92.2234 148.419 95.2789 143.836 Q98.3576 139.23 104.168 139.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M134.33 142.933 Q130.719 142.933 128.89 146.498 Q127.084 150.04 127.084 157.169 Q127.084 164.276 128.89 167.841 Q130.719 171.382 134.33 171.382 Q137.964 171.382 139.769 167.841 Q141.598 164.276 141.598 157.169 Q141.598 150.04 139.769 146.498 Q137.964 142.933 134.33 142.933 M134.33 139.23 Q140.14 139.23 143.195 143.836 Q146.274 148.419 146.274 157.169 Q146.274 165.896 143.195 170.503 Q140.14 175.086 134.33 175.086 Q128.519 175.086 125.441 170.503 Q122.385 165.896 122.385 157.169 Q122.385 148.419 125.441 143.836 Q128.519 139.23 134.33 139.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip252)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="194.274,1404.18 223.859,1401.31 253.444,1393.57 283.028,1382.02 312.613,1367.45 342.198,1350.49 371.783,1331.64 401.368,1311.28 430.953,1289.75 460.537,1267.29 490.122,1244.14 519.707,1220.46 549.292,1196.4 578.877,1172.1 608.461,1147.65 638.046,1123.15 667.631,1098.67 697.216,1074.29 726.801,1050.05 756.386,1026 785.97,1002.19 815.555,978.642 845.14,955.396 874.725,932.477 904.31,909.905 933.894,887.699 963.479,865.874 993.064,844.445 1022.65,823.423 1052.23,802.818 1081.82,782.637 1111.4,762.885 1140.99,743.566 1170.57,724.683 1200.16,706.239 1229.74,688.236 1259.33,670.674 1288.91,653.551 1318.5,636.865 1348.08,620.613 1377.67,604.792 1407.25,589.398 1436.84,574.429 1466.42,559.88 1496.01,545.747 1525.59,532.023 1555.18,518.7 1584.76,505.773 1614.35,493.235 1643.93,481.079 1673.51,469.299 1703.1,457.888 1732.68,446.84 1762.27,436.146 1791.85,425.799 1821.44,415.789 1851.02,406.11 1880.61,396.752 1910.19,387.708 1939.78,378.971 1969.36,370.533 1998.95,362.387 2028.53,354.525 2058.12,346.94 2087.7,339.621 2117.29,332.562 2146.87,325.755 2176.46,319.193 2206.04,312.867 2235.63,306.772 2265.21,300.9 2294.8,295.246 2324.38,289.801 2353.97,284.559 2383.55,279.513 2413.14,274.656 2442.72,269.982 2472.31,265.485 2501.89,261.159 2531.47,256.997 2561.06,252.996 2590.64,249.148 2620.23,245.45 2649.81,241.895 2679.4,238.478 2708.98,235.194 2738.57,232.038 2768.15,229.006 2797.74,226.092 2827.32,223.294 2856.91,220.605 2886.49,218.023 2916.08,215.544 2945.66,213.164 2975.25,210.878 3004.83,208.684 3034.42,206.577 3064,204.555 3093.59,202.614 3123.17,200.75 3152.76,198.962 "/>
<circle clip-path="url(#clip252)" cx="460.537" cy="1274.59" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="756.386" cy="958.789" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="1052.23" cy="812.188" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="1348.08" cy="517.078" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="1643.93" cy="454.076" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="1939.78" cy="511.581" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="2235.63" cy="475.801" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="2531.47" cy="125.576" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="2827.32" cy="86.7664" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip252)" cx="3123.17" cy="341.67" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<path clip-path="url(#clip250)" d="M292.89 249.313 L931.931 249.313 L931.931 93.7926 L292.89 93.7926  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip250)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="292.89,249.313 931.931,249.313 931.931,93.7926 292.89,93.7926 292.89,249.313 "/>
<polyline clip-path="url(#clip250)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="325.762,145.633 522.994,145.633 "/>
<path clip-path="url(#clip250)" d="M555.866 128.353 L585.102 128.353 L585.102 132.288 L572.834 132.288 L572.834 162.913 L568.135 162.913 L568.135 132.288 L555.866 132.288 L555.866 128.353 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M597.486 140.968 Q596.769 140.552 595.912 140.366 Q595.079 140.158 594.06 140.158 Q590.449 140.158 588.505 142.519 Q586.584 144.857 586.584 149.255 L586.584 162.913 L582.301 162.913 L582.301 136.987 L586.584 136.987 L586.584 141.015 Q587.926 138.653 590.079 137.519 Q592.232 136.362 595.31 136.362 Q595.75 136.362 596.283 136.431 Q596.815 136.478 597.463 136.593 L597.486 140.968 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M601.514 152.681 L601.514 136.987 L605.773 136.987 L605.773 152.519 Q605.773 156.2 607.209 158.052 Q608.644 159.88 611.514 159.88 Q614.963 159.88 616.954 157.681 Q618.968 155.482 618.968 151.686 L618.968 136.987 L623.227 136.987 L623.227 162.913 L618.968 162.913 L618.968 158.931 Q617.417 161.292 615.357 162.45 Q613.32 163.584 610.611 163.584 Q606.144 163.584 603.829 160.806 Q601.514 158.028 601.514 152.681 M612.232 136.362 L612.232 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M654.176 148.885 L654.176 150.968 L634.593 150.968 Q634.87 155.366 637.232 157.681 Q639.616 159.973 643.852 159.973 Q646.306 159.973 648.597 159.371 Q650.912 158.769 653.181 157.565 L653.181 161.593 Q650.889 162.565 648.481 163.075 Q646.074 163.584 643.597 163.584 Q637.394 163.584 633.759 159.973 Q630.148 156.362 630.148 150.204 Q630.148 143.839 633.574 140.112 Q637.023 136.362 642.857 136.362 Q648.088 136.362 651.12 139.741 Q654.176 143.098 654.176 148.885 M649.917 147.635 Q649.87 144.14 647.949 142.056 Q646.051 139.973 642.903 139.973 Q639.338 139.973 637.185 141.987 Q635.056 144.001 634.732 147.658 L649.917 147.635 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M692.764 137.751 L692.764 141.778 Q690.958 140.853 689.014 140.39 Q687.069 139.927 684.986 139.927 Q681.815 139.927 680.217 140.899 Q678.643 141.871 678.643 143.815 Q678.643 145.297 679.778 146.153 Q680.912 146.987 684.338 147.751 L685.796 148.075 Q690.333 149.047 692.231 150.829 Q694.153 152.589 694.153 155.76 Q694.153 159.371 691.282 161.477 Q688.435 163.584 683.435 163.584 Q681.352 163.584 679.083 163.167 Q676.838 162.774 674.338 161.964 L674.338 157.565 Q676.699 158.792 678.991 159.417 Q681.282 160.019 683.528 160.019 Q686.537 160.019 688.157 159.001 Q689.778 157.959 689.778 156.084 Q689.778 154.348 688.597 153.422 Q687.44 152.496 683.481 151.64 L682 151.292 Q678.042 150.459 676.282 148.746 Q674.523 147.01 674.523 144.001 Q674.523 140.343 677.116 138.353 Q679.708 136.362 684.477 136.362 Q686.838 136.362 688.921 136.709 Q691.004 137.056 692.764 137.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M710.981 139.973 Q707.555 139.973 705.565 142.658 Q703.574 145.32 703.574 149.973 Q703.574 154.626 705.541 157.311 Q707.532 159.973 710.981 159.973 Q714.384 159.973 716.375 157.288 Q718.365 154.602 718.365 149.973 Q718.365 145.366 716.375 142.681 Q714.384 139.973 710.981 139.973 M710.981 136.362 Q716.537 136.362 719.708 139.973 Q722.879 143.584 722.879 149.973 Q722.879 156.339 719.708 159.973 Q716.537 163.584 710.981 163.584 Q705.402 163.584 702.231 159.973 Q699.083 156.339 699.083 149.973 Q699.083 143.584 702.231 139.973 Q705.402 136.362 710.981 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M729.939 126.894 L734.199 126.894 L734.199 162.913 L729.939 162.913 L729.939 126.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M742.671 152.681 L742.671 136.987 L746.93 136.987 L746.93 152.519 Q746.93 156.2 748.365 158.052 Q749.8 159.88 752.671 159.88 Q756.12 159.88 758.111 157.681 Q760.124 155.482 760.124 151.686 L760.124 136.987 L764.384 136.987 L764.384 162.913 L760.124 162.913 L760.124 158.931 Q758.573 161.292 756.513 162.45 Q754.476 163.584 751.768 163.584 Q747.3 163.584 744.986 160.806 Q742.671 158.028 742.671 152.681 M753.388 136.362 L753.388 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M777.37 129.626 L777.37 136.987 L786.143 136.987 L786.143 140.297 L777.37 140.297 L777.37 154.371 Q777.37 157.542 778.226 158.445 Q779.106 159.348 781.768 159.348 L786.143 159.348 L786.143 162.913 L781.768 162.913 Q776.837 162.913 774.962 161.084 Q773.087 159.232 773.087 154.371 L773.087 140.297 L769.962 140.297 L769.962 136.987 L773.087 136.987 L773.087 129.626 L777.37 129.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M791.745 136.987 L796.004 136.987 L796.004 162.913 L791.745 162.913 L791.745 136.987 M791.745 126.894 L796.004 126.894 L796.004 132.288 L791.745 132.288 L791.745 126.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M814.962 139.973 Q811.536 139.973 809.545 142.658 Q807.555 145.32 807.555 149.973 Q807.555 154.626 809.522 157.311 Q811.513 159.973 814.962 159.973 Q818.365 159.973 820.356 157.288 Q822.346 154.602 822.346 149.973 Q822.346 145.366 820.356 142.681 Q818.365 139.973 814.962 139.973 M814.962 136.362 Q820.518 136.362 823.689 139.973 Q826.86 143.584 826.86 149.973 Q826.86 156.339 823.689 159.973 Q820.518 163.584 814.962 163.584 Q809.383 163.584 806.212 159.973 Q803.064 156.339 803.064 149.973 Q803.064 143.584 806.212 139.973 Q809.383 136.362 814.962 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M855.471 147.265 L855.471 162.913 L851.212 162.913 L851.212 147.403 Q851.212 143.723 849.777 141.894 Q848.342 140.066 845.471 140.066 Q842.022 140.066 840.031 142.265 Q838.041 144.464 838.041 148.26 L838.041 162.913 L833.758 162.913 L833.758 136.987 L838.041 136.987 L838.041 141.015 Q839.568 138.677 841.629 137.519 Q843.712 136.362 846.42 136.362 Q850.888 136.362 853.179 139.14 Q855.471 141.894 855.471 147.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><circle clip-path="url(#clip250)" cx="424.378" cy="197.473" r="20.48" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="4.55111"/>
<path clip-path="url(#clip250)" d="M555.866 180.193 L562.834 180.193 L571.653 203.711 L580.519 180.193 L587.486 180.193 L587.486 214.753 L582.926 214.753 L582.926 184.406 L574.014 208.109 L569.315 208.109 L560.403 184.406 L560.403 214.753 L555.866 214.753 L555.866 180.193 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M618.759 200.725 L618.759 202.808 L599.176 202.808 Q599.454 207.206 601.815 209.521 Q604.199 211.813 608.435 211.813 Q610.889 211.813 613.181 211.211 Q615.496 210.609 617.764 209.405 L617.764 213.433 Q615.472 214.405 613.065 214.915 Q610.658 215.424 608.181 215.424 Q601.977 215.424 598.343 211.813 Q594.732 208.202 594.732 202.044 Q594.732 195.679 598.158 191.952 Q601.607 188.202 607.44 188.202 Q612.671 188.202 615.704 191.581 Q618.759 194.938 618.759 200.725 M614.5 199.475 Q614.454 195.98 612.533 193.896 Q610.634 191.813 607.486 191.813 Q603.922 191.813 601.769 193.827 Q599.639 195.841 599.315 199.498 L614.5 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M637.532 201.72 Q632.37 201.72 630.38 202.901 Q628.389 204.081 628.389 206.929 Q628.389 209.197 629.87 210.54 Q631.375 211.859 633.945 211.859 Q637.486 211.859 639.616 209.359 Q641.769 206.836 641.769 202.669 L641.769 201.72 L637.532 201.72 M646.028 199.961 L646.028 214.753 L641.769 214.753 L641.769 210.817 Q640.31 213.179 638.134 214.313 Q635.958 215.424 632.81 215.424 Q628.829 215.424 626.468 213.202 Q624.13 210.956 624.13 207.206 Q624.13 202.831 627.046 200.609 Q629.986 198.387 635.796 198.387 L641.769 198.387 L641.769 197.97 Q641.769 195.031 639.824 193.433 Q637.903 191.813 634.407 191.813 Q632.185 191.813 630.079 192.345 Q627.972 192.878 626.028 193.943 L626.028 190.007 Q628.366 189.105 630.565 188.665 Q632.764 188.202 634.847 188.202 Q640.472 188.202 643.25 191.118 Q646.028 194.035 646.028 199.961 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M671.329 189.591 L671.329 193.618 Q669.523 192.693 667.579 192.23 Q665.634 191.767 663.551 191.767 Q660.38 191.767 658.782 192.739 Q657.208 193.711 657.208 195.655 Q657.208 197.137 658.343 197.993 Q659.477 198.827 662.903 199.591 L664.361 199.915 Q668.898 200.887 670.796 202.669 Q672.717 204.429 672.717 207.6 Q672.717 211.211 669.847 213.317 Q667 215.424 662 215.424 Q659.917 215.424 657.648 215.007 Q655.403 214.614 652.903 213.804 L652.903 209.405 Q655.264 210.632 657.556 211.257 Q659.847 211.859 662.093 211.859 Q665.102 211.859 666.722 210.841 Q668.342 209.799 668.342 207.924 Q668.342 206.188 667.162 205.262 Q666.005 204.336 662.046 203.48 L660.565 203.132 Q656.606 202.299 654.847 200.586 Q653.088 198.85 653.088 195.841 Q653.088 192.183 655.681 190.193 Q658.273 188.202 663.042 188.202 Q665.403 188.202 667.486 188.549 Q669.569 188.896 671.329 189.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M679.06 204.521 L679.06 188.827 L683.319 188.827 L683.319 204.359 Q683.319 208.04 684.754 209.892 Q686.19 211.72 689.06 211.72 Q692.509 211.72 694.5 209.521 Q696.514 207.322 696.514 203.526 L696.514 188.827 L700.773 188.827 L700.773 214.753 L696.514 214.753 L696.514 210.771 Q694.963 213.132 692.903 214.29 Q690.866 215.424 688.157 215.424 Q683.69 215.424 681.375 212.646 Q679.06 209.868 679.06 204.521 M689.778 188.202 L689.778 188.202 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M724.569 192.808 Q723.851 192.392 722.995 192.206 Q722.162 191.998 721.143 191.998 Q717.532 191.998 715.588 194.359 Q713.666 196.697 713.666 201.095 L713.666 214.753 L709.384 214.753 L709.384 188.827 L713.666 188.827 L713.666 192.855 Q715.009 190.493 717.162 189.359 Q719.314 188.202 722.393 188.202 Q722.833 188.202 723.365 188.271 Q723.898 188.318 724.546 188.433 L724.569 192.808 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M750.171 200.725 L750.171 202.808 L730.588 202.808 Q730.865 207.206 733.226 209.521 Q735.611 211.813 739.847 211.813 Q742.3 211.813 744.592 211.211 Q746.907 210.609 749.175 209.405 L749.175 213.433 Q746.884 214.405 744.476 214.915 Q742.069 215.424 739.592 215.424 Q733.388 215.424 729.754 211.813 Q726.143 208.202 726.143 202.044 Q726.143 195.679 729.569 191.952 Q733.018 188.202 738.851 188.202 Q744.083 188.202 747.115 191.581 Q750.171 194.938 750.171 200.725 M745.912 199.475 Q745.865 195.98 743.944 193.896 Q742.046 191.813 738.898 191.813 Q735.333 191.813 733.18 193.827 Q731.05 195.841 730.726 199.498 L745.912 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M777.347 193.804 Q778.944 190.933 781.166 189.568 Q783.388 188.202 786.397 188.202 Q790.448 188.202 792.647 191.049 Q794.846 193.873 794.846 199.105 L794.846 214.753 L790.564 214.753 L790.564 199.243 Q790.564 195.517 789.245 193.711 Q787.925 191.906 785.217 191.906 Q781.907 191.906 779.985 194.105 Q778.064 196.304 778.064 200.1 L778.064 214.753 L773.782 214.753 L773.782 199.243 Q773.782 195.493 772.462 193.711 Q771.143 191.906 768.388 191.906 Q765.124 191.906 763.203 194.128 Q761.282 196.327 761.282 200.1 L761.282 214.753 L756.999 214.753 L756.999 188.827 L761.282 188.827 L761.282 192.855 Q762.74 190.47 764.777 189.336 Q766.814 188.202 769.615 188.202 Q772.439 188.202 774.407 189.637 Q776.397 191.072 777.347 193.804 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M825.518 200.725 L825.518 202.808 L805.934 202.808 Q806.212 207.206 808.573 209.521 Q810.957 211.813 815.194 211.813 Q817.647 211.813 819.939 211.211 Q822.254 210.609 824.522 209.405 L824.522 213.433 Q822.231 214.405 819.823 214.915 Q817.416 215.424 814.939 215.424 Q808.735 215.424 805.101 211.813 Q801.49 208.202 801.49 202.044 Q801.49 195.679 804.916 191.952 Q808.365 188.202 814.198 188.202 Q819.43 188.202 822.462 191.581 Q825.518 194.938 825.518 200.725 M821.258 199.475 Q821.212 195.98 819.291 193.896 Q817.393 191.813 814.244 191.813 Q810.68 191.813 808.527 193.827 Q806.397 195.841 806.073 199.498 L821.258 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M854.059 199.105 L854.059 214.753 L849.8 214.753 L849.8 199.243 Q849.8 195.563 848.365 193.734 Q846.929 191.906 844.059 191.906 Q840.61 191.906 838.619 194.105 Q836.629 196.304 836.629 200.1 L836.629 214.753 L832.346 214.753 L832.346 188.827 L836.629 188.827 L836.629 192.855 Q838.156 190.517 840.217 189.359 Q842.3 188.202 845.008 188.202 Q849.476 188.202 851.767 190.98 Q854.059 193.734 854.059 199.105 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M866.767 181.466 L866.767 188.827 L875.54 188.827 L875.54 192.137 L866.767 192.137 L866.767 206.211 Q866.767 209.382 867.624 210.285 Q868.503 211.188 871.165 211.188 L875.54 211.188 L875.54 214.753 L871.165 214.753 Q866.235 214.753 864.36 212.924 Q862.485 211.072 862.485 206.211 L862.485 192.137 L859.36 192.137 L859.36 188.827 L862.485 188.827 L862.485 181.466 L866.767 181.466 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip250)" d="M897.67 189.591 L897.67 193.618 Q895.864 192.693 893.92 192.23 Q891.976 191.767 889.892 191.767 Q886.721 191.767 885.124 192.739 Q883.55 193.711 883.55 195.655 Q883.55 197.137 884.684 197.993 Q885.818 198.827 889.244 199.591 L890.702 199.915 Q895.239 200.887 897.138 202.669 Q899.059 204.429 899.059 207.6 Q899.059 211.211 896.188 213.317 Q893.341 215.424 888.341 215.424 Q886.258 215.424 883.989 215.007 Q881.744 214.614 879.244 213.804 L879.244 209.405 Q881.605 210.632 883.897 211.257 Q886.189 211.859 888.434 211.859 Q891.443 211.859 893.064 210.841 Q894.684 209.799 894.684 207.924 Q894.684 206.188 893.503 205.262 Q892.346 204.336 888.388 203.48 L886.906 203.132 Q882.948 202.299 881.189 200.586 Q879.429 198.85 879.429 195.841 Q879.429 192.183 882.022 190.193 Q884.614 188.202 889.383 188.202 Q891.744 188.202 893.827 188.549 Q895.911 188.896 897.67 189.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Generally, PEtab takes five different inputs to define an optimisation problem (the minimiser of which generates a fitted parameter set):</p><ol><li><strong>Model</strong>: The model which we want to fit to the data (a <code>ReactionSystem</code>).</li><li><strong>Observables</strong>: The possible observables that can be measured (a <code>Dict{String,PEtabObservable}</code>).</li><li><strong>Estimation parameters</strong>: The parameters which we want to fit to the data (a <code>Vector{PEtabParameter}</code>). </li><li><strong>Experimental (or simulation) conditions</strong>: The simulations (each corresponding to a potential experiment) carried out during each step of the optimisation process (a <code>Dict{String,Dict{Symbol,Float64}}</code>).</li><li><strong>Measurements</strong>: The measurements to which the model is fitted (a <code>DataFrame</code>). </li></ol><h3 id="Observables"><a class="docs-heading-anchor" href="#Observables">Observables</a><a id="Observables-1"></a><a class="docs-heading-anchor-permalink" href="#Observables" title="Permalink"></a></h3><p>The observables define the quantities that we may measure in our experiments. Typically, each corresponds to a single species, however, <a href="#petab_observables_observables">more complicated observables are possible</a>. For each observable, we also need a noise formula, defining the uncertainty in its measurements. By default, PEtab assumes normally distributed noise, with a mean equal to the true value and a standard deviation which we have to define. It is also possible to use <a href="#petab_observables_noise_formula">more advanced noise formulas</a>.</p><p>In our example, we only have a single possible observable, the <code>P</code> species. We will assume that the noise is normally distributed with a standard deviation <code>0.5</code> (in our case this is not true, however, typically the noise distribution is unknown and a guess have to be made). We combine this information in a <code>PEtabObservable</code> struct (to access the <code>P</code> species we must use <a href="../../catalyst_applications/simulation_structure_interfacing/#simulation_structure_interfacing_symbolic_representation"><code>@unpack</code></a>). Finally, we store all our observables in a dictionary, giving each an id tag (which is later used in the measurements input).</p><pre><code class="language-julia hljs">@unpack P = rn
obs_P = PEtabObservable(P, 0.5)
observables = Dict(&quot;obs_P&quot; =&gt; obs_P)</code></pre><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><p>Each parameter of the system can either be</p><ol><li>Known (described <a href="#petab_parameters_known">here</a>).</li><li>Depend on experimental/simulation conditions (described <a href="#petab_simulation_conditions">here</a>). </li><li>Be an unknown that we wish to fit to data.</li></ol><p>In our case, we wish to fit all three system parameters (<em>kB</em>, <em>kD</em>, and <em>kP</em>). For each, we create a single <code>PEtabParameter</code>, and then gather these into a single vector.</p><pre><code class="language-julia hljs">par_kB = PEtabParameter(:kB)
par_kD = PEtabParameter(:kD)
par_kP = PEtabParameter(:kP)
params = [par_kB, par_kD, par_kP]</code></pre><p>For each parameter, it is also possible to set <a href="#petab_parameters_bounds">a lower and/or upper bound</a> (by default, <em>(0.001,1000)</em> is used), set whether to use <a href="#petab_parameters_scales">logarithmic or linear scale</a>, or add a <a href="#petab_parameters_priors">prior distribution of its value</a>.</p><h3 id="Simulation-conditions"><a class="docs-heading-anchor" href="#Simulation-conditions">Simulation conditions</a><a id="Simulation-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-conditions" title="Permalink"></a></h3><p>Sometimes, several different experiments are performed on a system (each potentially generating several measurements). An experiment could e.g. be the time development of a system from a specific initial condition. Since each experimental condition (during the optimisation procedure, for a guess of the unknown parameters) generates a distinct simulation, these are also called simulation conditions. In our example, all data comes from a single experiment, and the simulation condition input is not required. How to define and use different experimental conditions is described <a href="#petab_simulation_conditions">here</a>.</p><h3 id="Measurements"><a class="docs-heading-anchor" href="#Measurements">Measurements</a><a id="Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Measurements" title="Permalink"></a></h3><p>Finally, we need to define the system measurements to which the parameters will be fitted. Each measurement combines:</p><ol><li>The observable which is observed (here we use the id tag defined in the <code>observables</code> dictionary).</li><li>The time point of the measurement.</li><li>The measured value.</li></ol><p>For cases where several simulation conditions are given, we also need to provide:</p><ol><li>The simulation condition which generates the measurement (<a href="#petab_simulation_conditions">here</a> is an example where this is used).</li></ol><p>([When <a href="https://sebapersson.github.io/PEtab.jl/stable/Brannmark/">pre-equilibration</a> is used to initiate the system in a steady state, a fifth field is also required])</p><p>Measurements are provided in a <code>DataFrame</code> where each row corresponds to a measurement. The values are provided in the <code>obs_id</code>, <code>time</code>, <code>measurement</code>, and <code>simulation_id</code> columns. In our case we only need to fill in the first three:</p><pre><code class="language-julia hljs">using DataFrames
measurements = DataFrame(obs_id=&quot;obs_P&quot;, time=sol.t[10:10:end], measurement=data)</code></pre><div><div style = "float: left;"><span>10×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">obs_id</th><th style = "text-align: left;">time</th><th style = "text-align: left;">measurement</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">0.9</td><td style = "text-align: right;">0.103917</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">1.9</td><td style = "text-align: right;">0.357156</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">2.9</td><td style = "text-align: right;">0.474715</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">3.9</td><td style = "text-align: right;">0.711363</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">4.9</td><td style = "text-align: right;">0.761884</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">5.9</td><td style = "text-align: right;">0.71577</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">6.9</td><td style = "text-align: right;">0.744463</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">7.9</td><td style = "text-align: right;">1.02531</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">8.9</td><td style = "text-align: right;">1.05643</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">obs_P</td><td style = "text-align: right;">9.9</td><td style = "text-align: right;">0.852021</td></tr></tbody></table></div><p>Since, in our example, all measurements are of the same observable, we can set <code>obs_id=&quot;obs_P&quot;</code>. If several different observables were measured, <code>obs_id</code> would be a vector of the same length as <code>time</code> and <code>measurement</code>.</p><h3 id="Creating-a-PEtabModel"><a class="docs-heading-anchor" href="#Creating-a-PEtabModel">Creating a PEtabModel</a><a id="Creating-a-PEtabModel-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-PEtabModel" title="Permalink"></a></h3><p>Finally, we combine all inputs in a single <code>PEtabModel</code>. To it, we also pass the initial conditions of our simulations (using the <code>state_map</code> argument). It is also possible to have <a href="#petab_simulation_initial_conditions_uncertainty">initial conditions with uncertainty</a>, <a href="#petab_simulation_conditions">that vary between different simulations</a>, or <a href="#petab_simulation_initial_conditions_fitted">that we attempt to fit to the data</a>.</p><pre><code class="language-julia hljs">petab_model = PEtabModel(rn, observables, measurements, params; state_map=u0)</code></pre><h3 id="Fitting-parameters"><a class="docs-heading-anchor" href="#Fitting-parameters">Fitting parameters</a><a id="Fitting-parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Fitting-parameters" title="Permalink"></a></h3><p>We are now able to fit our model to the data. First, we create a <code>PEtabODEProblem</code>. Here, we use <code>petab_model</code> as the only input, but it is also possible to set various <a href="#petab_simulation_options">numeric solver and automatic differentiation options</a> (such as method or tolerance).</p><pre><code class="language-julia hljs">petab_problem = PEtabODEProblem(petab_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Building PEtabODEProblem for ReactionSystemModel
[ Info: Building ODEProblem from ODESystem ... done. Time = 1.3e+01
[ Info: Building cost function for method Standard ... done. Time = 2.0e-05
[ Info: Building gradient function for method ForwardDiff ... done. Time = 7.9e-01
[ Info: Building hessian function for method ForwardDiff ... done. Time = 5.0e-01</code></pre><p>Since no additional input is given, default optiosn are selected by PEtab.jl (and generally, its choices are good).</p><p>To fit a parameter set we use the <code>calibrate_model</code> function. In addition to our <code>PEtabODEProblem</code>, we must also provide an initial guess (which can be generated with the <code>generate_startguesses</code> function) and an optimisation algorithm (which needs to be imported specifically). PEtab.jl supports various <a href="#petab_optimisation_optimisers">optimisation methods and options</a>. </p><pre><code class="language-julia hljs">using Optim
p0 = generate_startguesses(petab_problem, 1)
res = calibrate_model(petab_problem, p0, IPNewton())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabOptimisationResult
--------- Summary ---------
min(f)                = 2.40e+00
Parameters esimtated  = 3
Optimiser iterations  = 26
Run time              = 4.2e+00s
Optimiser algorithm   = Optim_IPNewton
</code></pre><p>We can now simulate our model for the fitted parameter set, and compare the result to the measurements and true solution.</p><pre><code class="language-julia hljs">oprob = ODEProblem(rn, u0, (0.0, 10.0), get_ps(res, petab_problem))
sol = solve(oprob, Tsit5(); saveat=0.1)
plot!(sol; idxs=4, label=&quot;Fitted solution&quot;)</code></pre><?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800" height="400" viewBox="0 0 3200 1600">
<defs>
  <clipPath id="clip310">
    <rect x="0" y="0" width="3200" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip310)" d="M0 1600 L3200 1600 L3200 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip311">
    <rect x="640" y="0" width="2241" height="1600"/>
  </clipPath>
</defs>
<path clip-path="url(#clip310)" d="M194.274 1443.7 L3152.76 1443.7 L3152.76 47.2441 L194.274 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<defs>
  <clipPath id="clip312">
    <rect x="194" y="47" width="2959" height="1397"/>
  </clipPath>
</defs>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1443.7 194.274,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="785.97,1443.7 785.97,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1377.67,1443.7 1377.67,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1969.36,1443.7 1969.36,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2561.06,1443.7 2561.06,47.2441 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="3152.76,1443.7 3152.76,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 3152.76,1443.7 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,47.2441 3152.76,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 194.274,1424.8 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="785.97,1443.7 785.97,1424.8 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1377.67,1443.7 1377.67,1424.8 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1969.36,1443.7 1969.36,1424.8 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2561.06,1443.7 2561.06,1424.8 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="3152.76,1443.7 3152.76,1424.8 "/>
<path clip-path="url(#clip310)" d="M194.274 1481.02 Q190.663 1481.02 188.834 1484.58 Q187.029 1488.12 187.029 1495.25 Q187.029 1502.36 188.834 1505.93 Q190.663 1509.47 194.274 1509.47 Q197.908 1509.47 199.714 1505.93 Q201.542 1502.36 201.542 1495.25 Q201.542 1488.12 199.714 1484.58 Q197.908 1481.02 194.274 1481.02 M194.274 1477.31 Q200.084 1477.31 203.14 1481.92 Q206.218 1486.5 206.218 1495.25 Q206.218 1503.98 203.14 1508.59 Q200.084 1513.17 194.274 1513.17 Q188.464 1513.17 185.385 1508.59 Q182.33 1503.98 182.33 1495.25 Q182.33 1486.5 185.385 1481.92 Q188.464 1477.31 194.274 1477.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M780.623 1508.56 L796.943 1508.56 L796.943 1512.5 L774.998 1512.5 L774.998 1508.56 Q777.66 1505.81 782.244 1501.18 Q786.85 1496.53 788.031 1495.19 Q790.276 1492.66 791.156 1490.93 Q792.058 1489.17 792.058 1487.48 Q792.058 1484.72 790.114 1482.99 Q788.193 1481.25 785.091 1481.25 Q782.892 1481.25 780.438 1482.01 Q778.007 1482.78 775.23 1484.33 L775.23 1479.61 Q778.054 1478.47 780.507 1477.89 Q782.961 1477.31 784.998 1477.31 Q790.369 1477.31 793.563 1480 Q796.757 1482.69 796.757 1487.18 Q796.757 1489.31 795.947 1491.23 Q795.16 1493.12 793.054 1495.72 Q792.475 1496.39 789.373 1499.61 Q786.271 1502.8 780.623 1508.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1380.68 1482.01 L1368.87 1500.46 L1380.68 1500.46 L1380.68 1482.01 M1379.45 1477.94 L1385.33 1477.94 L1385.33 1500.46 L1390.26 1500.46 L1390.26 1504.35 L1385.33 1504.35 L1385.33 1512.5 L1380.68 1512.5 L1380.68 1504.35 L1365.07 1504.35 L1365.07 1499.84 L1379.45 1477.94 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1969.77 1493.36 Q1966.62 1493.36 1964.77 1495.51 Q1962.94 1497.66 1962.94 1501.41 Q1962.94 1505.14 1964.77 1507.31 Q1966.62 1509.47 1969.77 1509.47 Q1972.92 1509.47 1974.75 1507.31 Q1976.6 1505.14 1976.6 1501.41 Q1976.6 1497.66 1974.75 1495.51 Q1972.92 1493.36 1969.77 1493.36 M1979.05 1478.7 L1979.05 1482.96 Q1977.29 1482.13 1975.49 1481.69 Q1973.7 1481.25 1971.94 1481.25 Q1967.31 1481.25 1964.86 1484.37 Q1962.43 1487.5 1962.08 1493.82 Q1963.45 1491.81 1965.51 1490.74 Q1967.57 1489.65 1970.05 1489.65 Q1975.25 1489.65 1978.26 1492.82 Q1981.3 1495.97 1981.3 1501.41 Q1981.3 1506.74 1978.15 1509.95 Q1975 1513.17 1969.77 1513.17 Q1963.77 1513.17 1960.6 1508.59 Q1957.43 1503.98 1957.43 1495.25 Q1957.43 1487.06 1961.32 1482.2 Q1965.21 1477.31 1971.76 1477.31 Q1973.52 1477.31 1975.3 1477.66 Q1977.11 1478.01 1979.05 1478.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M2561.06 1496.09 Q2557.73 1496.09 2555.8 1497.87 Q2553.91 1499.65 2553.91 1502.78 Q2553.91 1505.9 2555.8 1507.69 Q2557.73 1509.47 2561.06 1509.47 Q2564.39 1509.47 2566.31 1507.69 Q2568.24 1505.88 2568.24 1502.78 Q2568.24 1499.65 2566.31 1497.87 Q2564.42 1496.09 2561.06 1496.09 M2556.38 1494.1 Q2553.37 1493.36 2551.68 1491.3 Q2550.02 1489.24 2550.02 1486.27 Q2550.02 1482.13 2552.96 1479.72 Q2555.92 1477.31 2561.06 1477.31 Q2566.22 1477.31 2569.16 1479.72 Q2572.1 1482.13 2572.1 1486.27 Q2572.1 1489.24 2570.41 1491.3 Q2568.74 1493.36 2565.76 1494.1 Q2569.14 1494.88 2571.01 1497.18 Q2572.91 1499.47 2572.91 1502.78 Q2572.91 1507.8 2569.83 1510.49 Q2566.78 1513.17 2561.06 1513.17 Q2555.34 1513.17 2552.26 1510.49 Q2549.21 1507.8 2549.21 1502.78 Q2549.21 1499.47 2551.11 1497.18 Q2553 1494.88 2556.38 1494.1 M2554.67 1486.71 Q2554.67 1489.4 2556.34 1490.9 Q2558.03 1492.41 2561.06 1492.41 Q2564.07 1492.41 2565.76 1490.9 Q2567.47 1489.4 2567.47 1486.71 Q2567.47 1484.03 2565.76 1482.52 Q2564.07 1481.02 2561.06 1481.02 Q2558.03 1481.02 2556.34 1482.52 Q2554.67 1484.03 2554.67 1486.71 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M3127.44 1508.56 L3135.08 1508.56 L3135.08 1482.2 L3126.77 1483.87 L3126.77 1479.61 L3135.04 1477.94 L3139.71 1477.94 L3139.71 1508.56 L3147.35 1508.56 L3147.35 1512.5 L3127.44 1512.5 L3127.44 1508.56 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M3166.8 1481.02 Q3163.18 1481.02 3161.36 1484.58 Q3159.55 1488.12 3159.55 1495.25 Q3159.55 1502.36 3161.36 1505.93 Q3163.18 1509.47 3166.8 1509.47 Q3170.43 1509.47 3172.23 1505.93 Q3174.06 1502.36 3174.06 1495.25 Q3174.06 1488.12 3172.23 1484.58 Q3170.43 1481.02 3166.8 1481.02 M3166.8 1477.31 Q3172.61 1477.31 3175.66 1481.92 Q3178.74 1486.5 3178.74 1495.25 Q3178.74 1503.98 3175.66 1508.59 Q3172.61 1513.17 3166.8 1513.17 Q3160.99 1513.17 3157.91 1508.59 Q3154.85 1503.98 3154.85 1495.25 Q3154.85 1486.5 3157.91 1481.92 Q3160.99 1477.31 3166.8 1477.31 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M1672.58 1554.79 L1672.58 1564.92 L1684.64 1564.92 L1684.64 1569.47 L1672.58 1569.47 L1672.58 1588.82 Q1672.58 1593.18 1673.75 1594.42 Q1674.96 1595.66 1678.62 1595.66 L1684.64 1595.66 L1684.64 1600.56 L1678.62 1600.56 Q1671.84 1600.56 1669.27 1598.05 Q1666.69 1595.5 1666.69 1588.82 L1666.69 1569.47 L1662.39 1569.47 L1662.39 1564.92 L1666.69 1564.92 L1666.69 1554.79 L1672.58 1554.79 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1404.18 3152.76,1404.18 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,1092.42 3152.76,1092.42 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,780.656 3152.76,780.656 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,468.895 3152.76,468.895 "/>
<polyline clip-path="url(#clip312)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="194.274,157.135 3152.76,157.135 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1443.7 194.274,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="3152.76,1443.7 3152.76,47.2441 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1404.18 213.172,1404.18 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,1092.42 213.172,1092.42 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,780.656 213.172,780.656 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,468.895 213.172,468.895 "/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="194.274,157.135 213.172,157.135 "/>
<path clip-path="url(#clip310)" d="M58.9365 1389.98 Q55.3254 1389.98 53.4967 1393.54 Q51.6912 1397.08 51.6912 1404.21 Q51.6912 1411.32 53.4967 1414.88 Q55.3254 1418.43 58.9365 1418.43 Q62.5707 1418.43 64.3763 1414.88 Q66.205 1411.32 66.205 1404.21 Q66.205 1397.08 64.3763 1393.54 Q62.5707 1389.98 58.9365 1389.98 M58.9365 1386.27 Q64.7467 1386.27 67.8022 1390.88 Q70.8809 1395.46 70.8809 1404.21 Q70.8809 1412.94 67.8022 1417.55 Q64.7467 1422.13 58.9365 1422.13 Q53.1264 1422.13 50.0477 1417.55 Q46.9921 1412.94 46.9921 1404.21 Q46.9921 1395.46 50.0477 1390.88 Q53.1264 1386.27 58.9365 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M79.0984 1415.58 L83.9827 1415.58 L83.9827 1421.46 L79.0984 1421.46 L79.0984 1415.58 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M104.168 1389.98 Q100.557 1389.98 98.728 1393.54 Q96.9224 1397.08 96.9224 1404.21 Q96.9224 1411.32 98.728 1414.88 Q100.557 1418.43 104.168 1418.43 Q107.802 1418.43 109.608 1414.88 Q111.436 1411.32 111.436 1404.21 Q111.436 1397.08 109.608 1393.54 Q107.802 1389.98 104.168 1389.98 M104.168 1386.27 Q109.978 1386.27 113.033 1390.88 Q116.112 1395.46 116.112 1404.21 Q116.112 1412.94 113.033 1417.55 Q109.978 1422.13 104.168 1422.13 Q98.3576 1422.13 95.2789 1417.55 Q92.2234 1412.94 92.2234 1404.21 Q92.2234 1395.46 95.2789 1390.88 Q98.3576 1386.27 104.168 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M134.33 1389.98 Q130.719 1389.98 128.89 1393.54 Q127.084 1397.08 127.084 1404.21 Q127.084 1411.32 128.89 1414.88 Q130.719 1418.43 134.33 1418.43 Q137.964 1418.43 139.769 1414.88 Q141.598 1411.32 141.598 1404.21 Q141.598 1397.08 139.769 1393.54 Q137.964 1389.98 134.33 1389.98 M134.33 1386.27 Q140.14 1386.27 143.195 1390.88 Q146.274 1395.46 146.274 1404.21 Q146.274 1412.94 143.195 1417.55 Q140.14 1422.13 134.33 1422.13 Q128.519 1422.13 125.441 1417.55 Q122.385 1412.94 122.385 1404.21 Q122.385 1395.46 125.441 1390.88 Q128.519 1386.27 134.33 1386.27 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M59.9319 1078.22 Q56.3208 1078.22 54.4921 1081.78 Q52.6865 1085.32 52.6865 1092.45 Q52.6865 1099.56 54.4921 1103.12 Q56.3208 1106.66 59.9319 1106.66 Q63.5661 1106.66 65.3717 1103.12 Q67.2004 1099.56 67.2004 1092.45 Q67.2004 1085.32 65.3717 1081.78 Q63.5661 1078.22 59.9319 1078.22 M59.9319 1074.51 Q65.742 1074.51 68.7976 1079.12 Q71.8763 1083.7 71.8763 1092.45 Q71.8763 1101.18 68.7976 1105.78 Q65.742 1110.37 59.9319 1110.37 Q54.1217 1110.37 51.043 1105.78 Q47.9875 1101.18 47.9875 1092.45 Q47.9875 1083.7 51.043 1079.12 Q54.1217 1074.51 59.9319 1074.51 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M80.0938 1103.82 L84.978 1103.82 L84.978 1109.7 L80.0938 1109.7 L80.0938 1103.82 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M99.1909 1105.76 L115.51 1105.76 L115.51 1109.7 L93.566 1109.7 L93.566 1105.76 Q96.228 1103.01 100.811 1098.38 Q105.418 1093.72 106.598 1092.38 Q108.844 1089.86 109.723 1088.12 Q110.626 1086.36 110.626 1084.67 Q110.626 1081.92 108.682 1080.18 Q106.76 1078.45 103.658 1078.45 Q101.459 1078.45 99.0057 1079.21 Q96.5752 1079.97 93.7974 1081.53 L93.7974 1076.8 Q96.6215 1075.67 99.0752 1075.09 Q101.529 1074.51 103.566 1074.51 Q108.936 1074.51 112.131 1077.2 Q115.325 1079.88 115.325 1084.37 Q115.325 1086.5 114.515 1088.42 Q113.728 1090.32 111.621 1092.91 Q111.043 1093.59 107.941 1096.8 Q104.839 1100 99.1909 1105.76 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M125.371 1075.14 L143.728 1075.14 L143.728 1079.07 L129.654 1079.07 L129.654 1087.54 Q130.672 1087.2 131.691 1087.03 Q132.709 1086.85 133.728 1086.85 Q139.515 1086.85 142.894 1090.02 Q146.274 1093.19 146.274 1098.61 Q146.274 1104.19 142.802 1107.29 Q139.33 1110.37 133.01 1110.37 Q130.834 1110.37 128.566 1110 Q126.32 1109.63 123.913 1108.89 L123.913 1104.19 Q125.996 1105.32 128.219 1105.88 Q130.441 1106.43 132.918 1106.43 Q136.922 1106.43 139.26 1104.33 Q141.598 1102.22 141.598 1098.61 Q141.598 1095 139.26 1092.89 Q136.922 1090.78 132.918 1090.78 Q131.043 1090.78 129.168 1091.2 Q127.316 1091.62 125.371 1092.5 L125.371 1075.14 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M58.9365 766.455 Q55.3254 766.455 53.4967 770.02 Q51.6912 773.561 51.6912 780.691 Q51.6912 787.797 53.4967 791.362 Q55.3254 794.904 58.9365 794.904 Q62.5707 794.904 64.3763 791.362 Q66.205 787.797 66.205 780.691 Q66.205 773.561 64.3763 770.02 Q62.5707 766.455 58.9365 766.455 M58.9365 762.751 Q64.7467 762.751 67.8022 767.358 Q70.8809 771.941 70.8809 780.691 Q70.8809 789.418 67.8022 794.024 Q64.7467 798.607 58.9365 798.607 Q53.1264 798.607 50.0477 794.024 Q46.9921 789.418 46.9921 780.691 Q46.9921 771.941 50.0477 767.358 Q53.1264 762.751 58.9365 762.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M79.0984 792.056 L83.9827 792.056 L83.9827 797.936 L79.0984 797.936 L79.0984 792.056 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M94.2141 763.376 L112.57 763.376 L112.57 767.311 L98.4965 767.311 L98.4965 775.783 Q99.515 775.436 100.534 775.274 Q101.552 775.089 102.571 775.089 Q108.358 775.089 111.737 778.26 Q115.117 781.432 115.117 786.848 Q115.117 792.427 111.645 795.529 Q108.172 798.607 101.853 798.607 Q99.677 798.607 97.4085 798.237 Q95.1632 797.867 92.7558 797.126 L92.7558 792.427 Q94.8391 793.561 97.0613 794.117 Q99.2835 794.672 101.76 794.672 Q105.765 794.672 108.103 792.566 Q110.441 790.459 110.441 786.848 Q110.441 783.237 108.103 781.131 Q105.765 779.024 101.76 779.024 Q99.8854 779.024 98.0104 779.441 Q96.1585 779.857 94.2141 780.737 L94.2141 763.376 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M134.33 766.455 Q130.719 766.455 128.89 770.02 Q127.084 773.561 127.084 780.691 Q127.084 787.797 128.89 791.362 Q130.719 794.904 134.33 794.904 Q137.964 794.904 139.769 791.362 Q141.598 787.797 141.598 780.691 Q141.598 773.561 139.769 770.02 Q137.964 766.455 134.33 766.455 M134.33 762.751 Q140.14 762.751 143.195 767.358 Q146.274 771.941 146.274 780.691 Q146.274 789.418 143.195 794.024 Q140.14 798.607 134.33 798.607 Q128.519 798.607 125.441 794.024 Q122.385 789.418 122.385 780.691 Q122.385 771.941 125.441 767.358 Q128.519 762.751 134.33 762.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M59.9319 454.694 Q56.3208 454.694 54.4921 458.259 Q52.6865 461.8 52.6865 468.93 Q52.6865 476.036 54.4921 479.601 Q56.3208 483.143 59.9319 483.143 Q63.5661 483.143 65.3717 479.601 Q67.2004 476.036 67.2004 468.93 Q67.2004 461.8 65.3717 458.259 Q63.5661 454.694 59.9319 454.694 M59.9319 450.99 Q65.742 450.99 68.7976 455.597 Q71.8763 460.18 71.8763 468.93 Q71.8763 477.657 68.7976 482.263 Q65.742 486.847 59.9319 486.847 Q54.1217 486.847 51.043 482.263 Q47.9875 477.657 47.9875 468.93 Q47.9875 460.18 51.043 455.597 Q54.1217 450.99 59.9319 450.99 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M80.0938 480.296 L84.978 480.296 L84.978 486.175 L80.0938 486.175 L80.0938 480.296 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M93.9826 451.615 L116.205 451.615 L116.205 453.606 L103.658 486.175 L98.7743 486.175 L110.58 455.55 L93.9826 455.55 L93.9826 451.615 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M125.371 451.615 L143.728 451.615 L143.728 455.55 L129.654 455.55 L129.654 464.023 Q130.672 463.675 131.691 463.513 Q132.709 463.328 133.728 463.328 Q139.515 463.328 142.894 466.5 Q146.274 469.671 146.274 475.087 Q146.274 480.666 142.802 483.768 Q139.33 486.847 133.01 486.847 Q130.834 486.847 128.566 486.476 Q126.32 486.106 123.913 485.365 L123.913 480.666 Q125.996 481.8 128.219 482.356 Q130.441 482.911 132.918 482.911 Q136.922 482.911 139.26 480.805 Q141.598 478.699 141.598 475.087 Q141.598 471.476 139.26 469.37 Q136.922 467.263 132.918 467.263 Q131.043 467.263 129.168 467.68 Q127.316 468.097 125.371 468.976 L125.371 451.615 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M49.7467 170.479 L57.3856 170.479 L57.3856 144.114 L49.0754 145.78 L49.0754 141.521 L57.3393 139.855 L62.0152 139.855 L62.0152 170.479 L69.654 170.479 L69.654 174.415 L49.7467 174.415 L49.7467 170.479 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M79.0984 168.535 L83.9827 168.535 L83.9827 174.415 L79.0984 174.415 L79.0984 168.535 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M104.168 142.933 Q100.557 142.933 98.728 146.498 Q96.9224 150.04 96.9224 157.169 Q96.9224 164.276 98.728 167.841 Q100.557 171.382 104.168 171.382 Q107.802 171.382 109.608 167.841 Q111.436 164.276 111.436 157.169 Q111.436 150.04 109.608 146.498 Q107.802 142.933 104.168 142.933 M104.168 139.23 Q109.978 139.23 113.033 143.836 Q116.112 148.419 116.112 157.169 Q116.112 165.896 113.033 170.503 Q109.978 175.086 104.168 175.086 Q98.3576 175.086 95.2789 170.503 Q92.2234 165.896 92.2234 157.169 Q92.2234 148.419 95.2789 143.836 Q98.3576 139.23 104.168 139.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M134.33 142.933 Q130.719 142.933 128.89 146.498 Q127.084 150.04 127.084 157.169 Q127.084 164.276 128.89 167.841 Q130.719 171.382 134.33 171.382 Q137.964 171.382 139.769 167.841 Q141.598 164.276 141.598 157.169 Q141.598 150.04 139.769 146.498 Q137.964 142.933 134.33 142.933 M134.33 139.23 Q140.14 139.23 143.195 143.836 Q146.274 148.419 146.274 157.169 Q146.274 165.896 143.195 170.503 Q140.14 175.086 134.33 175.086 Q128.519 175.086 125.441 170.503 Q122.385 165.896 122.385 157.169 Q122.385 148.419 125.441 143.836 Q128.519 139.23 134.33 139.23 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip312)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="194.274,1404.18 223.859,1401.31 253.444,1393.57 283.028,1382.02 312.613,1367.45 342.198,1350.49 371.783,1331.64 401.368,1311.28 430.953,1289.75 460.537,1267.29 490.122,1244.14 519.707,1220.46 549.292,1196.4 578.877,1172.1 608.461,1147.65 638.046,1123.15 667.631,1098.67 697.216,1074.29 726.801,1050.05 756.386,1026 785.97,1002.19 815.555,978.642 845.14,955.396 874.725,932.477 904.31,909.905 933.894,887.699 963.479,865.874 993.064,844.445 1022.65,823.423 1052.23,802.818 1081.82,782.637 1111.4,762.885 1140.99,743.566 1170.57,724.683 1200.16,706.239 1229.74,688.236 1259.33,670.674 1288.91,653.551 1318.5,636.865 1348.08,620.613 1377.67,604.792 1407.25,589.398 1436.84,574.429 1466.42,559.88 1496.01,545.747 1525.59,532.023 1555.18,518.7 1584.76,505.773 1614.35,493.235 1643.93,481.079 1673.51,469.299 1703.1,457.888 1732.68,446.84 1762.27,436.146 1791.85,425.799 1821.44,415.789 1851.02,406.11 1880.61,396.752 1910.19,387.708 1939.78,378.971 1969.36,370.533 1998.95,362.387 2028.53,354.525 2058.12,346.94 2087.7,339.621 2117.29,332.562 2146.87,325.755 2176.46,319.193 2206.04,312.867 2235.63,306.772 2265.21,300.9 2294.8,295.246 2324.38,289.801 2353.97,284.559 2383.55,279.513 2413.14,274.656 2442.72,269.982 2472.31,265.485 2501.89,261.159 2531.47,256.997 2561.06,252.996 2590.64,249.148 2620.23,245.45 2649.81,241.895 2679.4,238.478 2708.98,235.194 2738.57,232.038 2768.15,229.006 2797.74,226.092 2827.32,223.294 2856.91,220.605 2886.49,218.023 2916.08,215.544 2945.66,213.164 2975.25,210.878 3004.83,208.684 3034.42,206.577 3064,204.555 3093.59,202.614 3123.17,200.75 3152.76,198.962 "/>
<circle clip-path="url(#clip312)" cx="460.537" cy="1274.59" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="756.386" cy="958.789" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="1052.23" cy="812.188" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="1348.08" cy="517.078" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="1643.93" cy="454.076" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="1939.78" cy="511.581" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="2235.63" cy="475.801" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="2531.47" cy="125.576" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="2827.32" cy="86.7664" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<circle clip-path="url(#clip312)" cx="3123.17" cy="341.67" r="14.4" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="3.2"/>
<polyline clip-path="url(#clip312)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="194.274,1404.18 223.859,1400.68 253.444,1391.24 283.028,1377.18 312.613,1359.56 342.198,1339.23 371.783,1316.87 401.368,1293 430.953,1268.06 460.537,1242.39 490.122,1216.27 519.707,1189.91 549.292,1163.5 578.877,1137.16 608.461,1111.02 638.046,1085.14 667.631,1059.61 697.216,1034.48 726.801,1009.78 756.386,985.548 785.97,961.805 815.555,938.565 845.14,915.841 874.725,893.642 904.31,871.97 933.894,850.824 963.479,830.201 993.064,810.1 1022.65,790.516 1052.23,771.445 1081.82,752.877 1111.4,734.805 1140.99,717.22 1170.57,700.113 1200.16,683.477 1229.74,667.302 1259.33,651.581 1288.91,636.301 1318.5,621.452 1348.08,607.025 1377.67,593.01 1407.25,579.399 1436.84,566.182 1466.42,553.35 1496.01,540.894 1525.59,528.804 1555.18,517.069 1584.76,505.68 1614.35,494.629 1643.93,483.908 1673.51,473.508 1703.1,463.423 1732.68,453.642 1762.27,444.158 1791.85,434.962 1821.44,426.045 1851.02,417.4 1880.61,409.019 1910.19,400.896 1939.78,393.024 1969.36,385.396 1998.95,378.005 2028.53,370.846 2058.12,363.909 2087.7,357.189 2117.29,350.679 2146.87,344.372 2176.46,338.264 2206.04,332.347 2235.63,326.618 2265.21,321.071 2294.8,315.701 2324.38,310.502 2353.97,305.47 2383.55,300.598 2413.14,295.881 2442.72,291.315 2472.31,286.895 2501.89,282.617 2531.47,278.476 2561.06,274.468 2590.64,270.59 2620.23,266.839 2649.81,263.21 2679.4,259.698 2708.98,256.301 2738.57,253.014 2768.15,249.833 2797.74,246.756 2827.32,243.779 2856.91,240.899 2886.49,238.113 2916.08,235.418 2945.66,232.811 2975.25,230.291 3004.83,227.854 3034.42,225.497 3064,223.217 3093.59,221.013 3123.17,218.881 3152.76,216.819 "/>
<path clip-path="url(#clip310)" d="M292.89 301.153 L931.931 301.153 L931.931 93.7926 L292.89 93.7926  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"/>
<polyline clip-path="url(#clip310)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="292.89,301.153 931.931,301.153 931.931,93.7926 292.89,93.7926 292.89,301.153 "/>
<polyline clip-path="url(#clip310)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="325.762,145.633 522.994,145.633 "/>
<path clip-path="url(#clip310)" d="M555.866 128.353 L585.102 128.353 L585.102 132.288 L572.834 132.288 L572.834 162.913 L568.135 162.913 L568.135 132.288 L555.866 132.288 L555.866 128.353 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M597.486 140.968 Q596.769 140.552 595.912 140.366 Q595.079 140.158 594.06 140.158 Q590.449 140.158 588.505 142.519 Q586.584 144.857 586.584 149.255 L586.584 162.913 L582.301 162.913 L582.301 136.987 L586.584 136.987 L586.584 141.015 Q587.926 138.653 590.079 137.519 Q592.232 136.362 595.31 136.362 Q595.75 136.362 596.283 136.431 Q596.815 136.478 597.463 136.593 L597.486 140.968 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M601.514 152.681 L601.514 136.987 L605.773 136.987 L605.773 152.519 Q605.773 156.2 607.209 158.052 Q608.644 159.88 611.514 159.88 Q614.963 159.88 616.954 157.681 Q618.968 155.482 618.968 151.686 L618.968 136.987 L623.227 136.987 L623.227 162.913 L618.968 162.913 L618.968 158.931 Q617.417 161.292 615.357 162.45 Q613.32 163.584 610.611 163.584 Q606.144 163.584 603.829 160.806 Q601.514 158.028 601.514 152.681 M612.232 136.362 L612.232 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M654.176 148.885 L654.176 150.968 L634.593 150.968 Q634.87 155.366 637.232 157.681 Q639.616 159.973 643.852 159.973 Q646.306 159.973 648.597 159.371 Q650.912 158.769 653.181 157.565 L653.181 161.593 Q650.889 162.565 648.481 163.075 Q646.074 163.584 643.597 163.584 Q637.394 163.584 633.759 159.973 Q630.148 156.362 630.148 150.204 Q630.148 143.839 633.574 140.112 Q637.023 136.362 642.857 136.362 Q648.088 136.362 651.12 139.741 Q654.176 143.098 654.176 148.885 M649.917 147.635 Q649.87 144.14 647.949 142.056 Q646.051 139.973 642.903 139.973 Q639.338 139.973 637.185 141.987 Q635.056 144.001 634.732 147.658 L649.917 147.635 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M692.764 137.751 L692.764 141.778 Q690.958 140.853 689.014 140.39 Q687.069 139.927 684.986 139.927 Q681.815 139.927 680.217 140.899 Q678.643 141.871 678.643 143.815 Q678.643 145.297 679.778 146.153 Q680.912 146.987 684.338 147.751 L685.796 148.075 Q690.333 149.047 692.231 150.829 Q694.153 152.589 694.153 155.76 Q694.153 159.371 691.282 161.477 Q688.435 163.584 683.435 163.584 Q681.352 163.584 679.083 163.167 Q676.838 162.774 674.338 161.964 L674.338 157.565 Q676.699 158.792 678.991 159.417 Q681.282 160.019 683.528 160.019 Q686.537 160.019 688.157 159.001 Q689.778 157.959 689.778 156.084 Q689.778 154.348 688.597 153.422 Q687.44 152.496 683.481 151.64 L682 151.292 Q678.042 150.459 676.282 148.746 Q674.523 147.01 674.523 144.001 Q674.523 140.343 677.116 138.353 Q679.708 136.362 684.477 136.362 Q686.838 136.362 688.921 136.709 Q691.004 137.056 692.764 137.751 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M710.981 139.973 Q707.555 139.973 705.565 142.658 Q703.574 145.32 703.574 149.973 Q703.574 154.626 705.541 157.311 Q707.532 159.973 710.981 159.973 Q714.384 159.973 716.375 157.288 Q718.365 154.602 718.365 149.973 Q718.365 145.366 716.375 142.681 Q714.384 139.973 710.981 139.973 M710.981 136.362 Q716.537 136.362 719.708 139.973 Q722.879 143.584 722.879 149.973 Q722.879 156.339 719.708 159.973 Q716.537 163.584 710.981 163.584 Q705.402 163.584 702.231 159.973 Q699.083 156.339 699.083 149.973 Q699.083 143.584 702.231 139.973 Q705.402 136.362 710.981 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M729.939 126.894 L734.199 126.894 L734.199 162.913 L729.939 162.913 L729.939 126.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M742.671 152.681 L742.671 136.987 L746.93 136.987 L746.93 152.519 Q746.93 156.2 748.365 158.052 Q749.8 159.88 752.671 159.88 Q756.12 159.88 758.111 157.681 Q760.124 155.482 760.124 151.686 L760.124 136.987 L764.384 136.987 L764.384 162.913 L760.124 162.913 L760.124 158.931 Q758.573 161.292 756.513 162.45 Q754.476 163.584 751.768 163.584 Q747.3 163.584 744.986 160.806 Q742.671 158.028 742.671 152.681 M753.388 136.362 L753.388 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M777.37 129.626 L777.37 136.987 L786.143 136.987 L786.143 140.297 L777.37 140.297 L777.37 154.371 Q777.37 157.542 778.226 158.445 Q779.106 159.348 781.768 159.348 L786.143 159.348 L786.143 162.913 L781.768 162.913 Q776.837 162.913 774.962 161.084 Q773.087 159.232 773.087 154.371 L773.087 140.297 L769.962 140.297 L769.962 136.987 L773.087 136.987 L773.087 129.626 L777.37 129.626 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M791.745 136.987 L796.004 136.987 L796.004 162.913 L791.745 162.913 L791.745 136.987 M791.745 126.894 L796.004 126.894 L796.004 132.288 L791.745 132.288 L791.745 126.894 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M814.962 139.973 Q811.536 139.973 809.545 142.658 Q807.555 145.32 807.555 149.973 Q807.555 154.626 809.522 157.311 Q811.513 159.973 814.962 159.973 Q818.365 159.973 820.356 157.288 Q822.346 154.602 822.346 149.973 Q822.346 145.366 820.356 142.681 Q818.365 139.973 814.962 139.973 M814.962 136.362 Q820.518 136.362 823.689 139.973 Q826.86 143.584 826.86 149.973 Q826.86 156.339 823.689 159.973 Q820.518 163.584 814.962 163.584 Q809.383 163.584 806.212 159.973 Q803.064 156.339 803.064 149.973 Q803.064 143.584 806.212 139.973 Q809.383 136.362 814.962 136.362 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M855.471 147.265 L855.471 162.913 L851.212 162.913 L851.212 147.403 Q851.212 143.723 849.777 141.894 Q848.342 140.066 845.471 140.066 Q842.022 140.066 840.031 142.265 Q838.041 144.464 838.041 148.26 L838.041 162.913 L833.758 162.913 L833.758 136.987 L838.041 136.987 L838.041 141.015 Q839.568 138.677 841.629 137.519 Q843.712 136.362 846.42 136.362 Q850.888 136.362 853.179 139.14 Q855.471 141.894 855.471 147.265 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><circle clip-path="url(#clip310)" cx="424.378" cy="197.473" r="20.48" fill="#e26f46" fill-rule="evenodd" fill-opacity="1" stroke="#000000" stroke-opacity="1" stroke-width="4.55111"/>
<path clip-path="url(#clip310)" d="M555.866 180.193 L562.834 180.193 L571.653 203.711 L580.519 180.193 L587.486 180.193 L587.486 214.753 L582.926 214.753 L582.926 184.406 L574.014 208.109 L569.315 208.109 L560.403 184.406 L560.403 214.753 L555.866 214.753 L555.866 180.193 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M618.759 200.725 L618.759 202.808 L599.176 202.808 Q599.454 207.206 601.815 209.521 Q604.199 211.813 608.435 211.813 Q610.889 211.813 613.181 211.211 Q615.496 210.609 617.764 209.405 L617.764 213.433 Q615.472 214.405 613.065 214.915 Q610.658 215.424 608.181 215.424 Q601.977 215.424 598.343 211.813 Q594.732 208.202 594.732 202.044 Q594.732 195.679 598.158 191.952 Q601.607 188.202 607.44 188.202 Q612.671 188.202 615.704 191.581 Q618.759 194.938 618.759 200.725 M614.5 199.475 Q614.454 195.98 612.533 193.896 Q610.634 191.813 607.486 191.813 Q603.922 191.813 601.769 193.827 Q599.639 195.841 599.315 199.498 L614.5 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M637.532 201.72 Q632.37 201.72 630.38 202.901 Q628.389 204.081 628.389 206.929 Q628.389 209.197 629.87 210.54 Q631.375 211.859 633.945 211.859 Q637.486 211.859 639.616 209.359 Q641.769 206.836 641.769 202.669 L641.769 201.72 L637.532 201.72 M646.028 199.961 L646.028 214.753 L641.769 214.753 L641.769 210.817 Q640.31 213.179 638.134 214.313 Q635.958 215.424 632.81 215.424 Q628.829 215.424 626.468 213.202 Q624.13 210.956 624.13 207.206 Q624.13 202.831 627.046 200.609 Q629.986 198.387 635.796 198.387 L641.769 198.387 L641.769 197.97 Q641.769 195.031 639.824 193.433 Q637.903 191.813 634.407 191.813 Q632.185 191.813 630.079 192.345 Q627.972 192.878 626.028 193.943 L626.028 190.007 Q628.366 189.105 630.565 188.665 Q632.764 188.202 634.847 188.202 Q640.472 188.202 643.25 191.118 Q646.028 194.035 646.028 199.961 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M671.329 189.591 L671.329 193.618 Q669.523 192.693 667.579 192.23 Q665.634 191.767 663.551 191.767 Q660.38 191.767 658.782 192.739 Q657.208 193.711 657.208 195.655 Q657.208 197.137 658.343 197.993 Q659.477 198.827 662.903 199.591 L664.361 199.915 Q668.898 200.887 670.796 202.669 Q672.717 204.429 672.717 207.6 Q672.717 211.211 669.847 213.317 Q667 215.424 662 215.424 Q659.917 215.424 657.648 215.007 Q655.403 214.614 652.903 213.804 L652.903 209.405 Q655.264 210.632 657.556 211.257 Q659.847 211.859 662.093 211.859 Q665.102 211.859 666.722 210.841 Q668.342 209.799 668.342 207.924 Q668.342 206.188 667.162 205.262 Q666.005 204.336 662.046 203.48 L660.565 203.132 Q656.606 202.299 654.847 200.586 Q653.088 198.85 653.088 195.841 Q653.088 192.183 655.681 190.193 Q658.273 188.202 663.042 188.202 Q665.403 188.202 667.486 188.549 Q669.569 188.896 671.329 189.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M679.06 204.521 L679.06 188.827 L683.319 188.827 L683.319 204.359 Q683.319 208.04 684.754 209.892 Q686.19 211.72 689.06 211.72 Q692.509 211.72 694.5 209.521 Q696.514 207.322 696.514 203.526 L696.514 188.827 L700.773 188.827 L700.773 214.753 L696.514 214.753 L696.514 210.771 Q694.963 213.132 692.903 214.29 Q690.866 215.424 688.157 215.424 Q683.69 215.424 681.375 212.646 Q679.06 209.868 679.06 204.521 M689.778 188.202 L689.778 188.202 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M724.569 192.808 Q723.851 192.392 722.995 192.206 Q722.162 191.998 721.143 191.998 Q717.532 191.998 715.588 194.359 Q713.666 196.697 713.666 201.095 L713.666 214.753 L709.384 214.753 L709.384 188.827 L713.666 188.827 L713.666 192.855 Q715.009 190.493 717.162 189.359 Q719.314 188.202 722.393 188.202 Q722.833 188.202 723.365 188.271 Q723.898 188.318 724.546 188.433 L724.569 192.808 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M750.171 200.725 L750.171 202.808 L730.588 202.808 Q730.865 207.206 733.226 209.521 Q735.611 211.813 739.847 211.813 Q742.3 211.813 744.592 211.211 Q746.907 210.609 749.175 209.405 L749.175 213.433 Q746.884 214.405 744.476 214.915 Q742.069 215.424 739.592 215.424 Q733.388 215.424 729.754 211.813 Q726.143 208.202 726.143 202.044 Q726.143 195.679 729.569 191.952 Q733.018 188.202 738.851 188.202 Q744.083 188.202 747.115 191.581 Q750.171 194.938 750.171 200.725 M745.912 199.475 Q745.865 195.98 743.944 193.896 Q742.046 191.813 738.898 191.813 Q735.333 191.813 733.18 193.827 Q731.05 195.841 730.726 199.498 L745.912 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M777.347 193.804 Q778.944 190.933 781.166 189.568 Q783.388 188.202 786.397 188.202 Q790.448 188.202 792.647 191.049 Q794.846 193.873 794.846 199.105 L794.846 214.753 L790.564 214.753 L790.564 199.243 Q790.564 195.517 789.245 193.711 Q787.925 191.906 785.217 191.906 Q781.907 191.906 779.985 194.105 Q778.064 196.304 778.064 200.1 L778.064 214.753 L773.782 214.753 L773.782 199.243 Q773.782 195.493 772.462 193.711 Q771.143 191.906 768.388 191.906 Q765.124 191.906 763.203 194.128 Q761.282 196.327 761.282 200.1 L761.282 214.753 L756.999 214.753 L756.999 188.827 L761.282 188.827 L761.282 192.855 Q762.74 190.47 764.777 189.336 Q766.814 188.202 769.615 188.202 Q772.439 188.202 774.407 189.637 Q776.397 191.072 777.347 193.804 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M825.518 200.725 L825.518 202.808 L805.934 202.808 Q806.212 207.206 808.573 209.521 Q810.957 211.813 815.194 211.813 Q817.647 211.813 819.939 211.211 Q822.254 210.609 824.522 209.405 L824.522 213.433 Q822.231 214.405 819.823 214.915 Q817.416 215.424 814.939 215.424 Q808.735 215.424 805.101 211.813 Q801.49 208.202 801.49 202.044 Q801.49 195.679 804.916 191.952 Q808.365 188.202 814.198 188.202 Q819.43 188.202 822.462 191.581 Q825.518 194.938 825.518 200.725 M821.258 199.475 Q821.212 195.98 819.291 193.896 Q817.393 191.813 814.244 191.813 Q810.68 191.813 808.527 193.827 Q806.397 195.841 806.073 199.498 L821.258 199.475 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M854.059 199.105 L854.059 214.753 L849.8 214.753 L849.8 199.243 Q849.8 195.563 848.365 193.734 Q846.929 191.906 844.059 191.906 Q840.61 191.906 838.619 194.105 Q836.629 196.304 836.629 200.1 L836.629 214.753 L832.346 214.753 L832.346 188.827 L836.629 188.827 L836.629 192.855 Q838.156 190.517 840.217 189.359 Q842.3 188.202 845.008 188.202 Q849.476 188.202 851.767 190.98 Q854.059 193.734 854.059 199.105 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M866.767 181.466 L866.767 188.827 L875.54 188.827 L875.54 192.137 L866.767 192.137 L866.767 206.211 Q866.767 209.382 867.624 210.285 Q868.503 211.188 871.165 211.188 L875.54 211.188 L875.54 214.753 L871.165 214.753 Q866.235 214.753 864.36 212.924 Q862.485 211.072 862.485 206.211 L862.485 192.137 L859.36 192.137 L859.36 188.827 L862.485 188.827 L862.485 181.466 L866.767 181.466 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M897.67 189.591 L897.67 193.618 Q895.864 192.693 893.92 192.23 Q891.976 191.767 889.892 191.767 Q886.721 191.767 885.124 192.739 Q883.55 193.711 883.55 195.655 Q883.55 197.137 884.684 197.993 Q885.818 198.827 889.244 199.591 L890.702 199.915 Q895.239 200.887 897.138 202.669 Q899.059 204.429 899.059 207.6 Q899.059 211.211 896.188 213.317 Q893.341 215.424 888.341 215.424 Q886.258 215.424 883.989 215.007 Q881.744 214.614 879.244 213.804 L879.244 209.405 Q881.605 210.632 883.897 211.257 Q886.189 211.859 888.434 211.859 Q891.443 211.859 893.064 210.841 Q894.684 209.799 894.684 207.924 Q894.684 206.188 893.503 205.262 Q892.346 204.336 888.388 203.48 L886.906 203.132 Q882.948 202.299 881.189 200.586 Q879.429 198.85 879.429 195.841 Q879.429 192.183 882.022 190.193 Q884.614 188.202 889.383 188.202 Q891.744 188.202 893.827 188.549 Q895.911 188.896 897.67 189.591 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><polyline clip-path="url(#clip310)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:12; stroke-opacity:1; fill:none" points="325.762,249.313 522.994,249.313 "/>
<path clip-path="url(#clip310)" d="M555.866 232.033 L575.727 232.033 L575.727 235.968 L560.542 235.968 L560.542 246.153 L574.246 246.153 L574.246 250.088 L560.542 250.088 L560.542 266.593 L555.866 266.593 L555.866 232.033 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M579.5 240.667 L583.76 240.667 L583.76 266.593 L579.5 266.593 L579.5 240.667 M579.5 230.574 L583.76 230.574 L583.76 235.968 L579.5 235.968 L579.5 230.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M596.885 233.306 L596.885 240.667 L605.658 240.667 L605.658 243.977 L596.885 243.977 L596.885 258.051 Q596.885 261.222 597.741 262.125 Q598.621 263.028 601.283 263.028 L605.658 263.028 L605.658 266.593 L601.283 266.593 Q596.352 266.593 594.477 264.764 Q592.602 262.912 592.602 258.051 L592.602 243.977 L589.477 243.977 L589.477 240.667 L592.602 240.667 L592.602 233.306 L596.885 233.306 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M615.472 233.306 L615.472 240.667 L624.245 240.667 L624.245 243.977 L615.472 243.977 L615.472 258.051 Q615.472 261.222 616.329 262.125 Q617.208 263.028 619.871 263.028 L624.245 263.028 L624.245 266.593 L619.871 266.593 Q614.94 266.593 613.065 264.764 Q611.19 262.912 611.19 258.051 L611.19 243.977 L608.065 243.977 L608.065 240.667 L611.19 240.667 L611.19 233.306 L615.472 233.306 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M652.023 252.565 L652.023 254.648 L632.44 254.648 Q632.718 259.046 635.079 261.361 Q637.463 263.653 641.699 263.653 Q644.153 263.653 646.444 263.051 Q648.759 262.449 651.028 261.245 L651.028 265.273 Q648.736 266.245 646.329 266.755 Q643.921 267.264 641.444 267.264 Q635.241 267.264 631.607 263.653 Q627.995 260.042 627.995 253.884 Q627.995 247.519 631.421 243.792 Q634.87 240.042 640.704 240.042 Q645.935 240.042 648.968 243.421 Q652.023 246.778 652.023 252.565 M647.764 251.315 Q647.718 247.82 645.796 245.736 Q643.898 243.653 640.75 243.653 Q637.185 243.653 635.032 245.667 Q632.903 247.681 632.579 251.338 L647.764 251.315 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M676.074 244.602 L676.074 230.574 L680.333 230.574 L680.333 266.593 L676.074 266.593 L676.074 262.704 Q674.731 265.019 672.671 266.153 Q670.634 267.264 667.764 267.264 Q663.065 267.264 660.102 263.514 Q657.162 259.764 657.162 253.653 Q657.162 247.542 660.102 243.792 Q663.065 240.042 667.764 240.042 Q670.634 240.042 672.671 241.176 Q674.731 242.287 676.074 244.602 M661.56 253.653 Q661.56 258.352 663.481 261.037 Q665.426 263.699 668.805 263.699 Q672.185 263.699 674.129 261.037 Q676.074 258.352 676.074 253.653 Q676.074 248.954 674.129 246.292 Q672.185 243.607 668.805 243.607 Q665.426 243.607 663.481 246.292 Q661.56 248.954 661.56 253.653 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M720.703 241.431 L720.703 245.458 Q718.898 244.533 716.953 244.07 Q715.009 243.607 712.926 243.607 Q709.754 243.607 708.157 244.579 Q706.583 245.551 706.583 247.495 Q706.583 248.977 707.717 249.833 Q708.852 250.667 712.277 251.431 L713.736 251.755 Q718.273 252.727 720.171 254.509 Q722.092 256.269 722.092 259.44 Q722.092 263.051 719.222 265.157 Q716.375 267.264 711.375 267.264 Q709.291 267.264 707.023 266.847 Q704.777 266.454 702.277 265.644 L702.277 261.245 Q704.639 262.472 706.93 263.097 Q709.222 263.699 711.467 263.699 Q714.476 263.699 716.097 262.681 Q717.717 261.639 717.717 259.764 Q717.717 258.028 716.537 257.102 Q715.379 256.176 711.421 255.32 L709.939 254.972 Q705.981 254.139 704.222 252.426 Q702.463 250.69 702.463 247.681 Q702.463 244.023 705.055 242.033 Q707.648 240.042 712.416 240.042 Q714.777 240.042 716.861 240.389 Q718.944 240.736 720.703 241.431 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M738.921 243.653 Q735.495 243.653 733.504 246.338 Q731.513 249 731.513 253.653 Q731.513 258.306 733.481 260.991 Q735.472 263.653 738.921 263.653 Q742.324 263.653 744.314 260.968 Q746.305 258.282 746.305 253.653 Q746.305 249.046 744.314 246.361 Q742.324 243.653 738.921 243.653 M738.921 240.042 Q744.476 240.042 747.648 243.653 Q750.819 247.264 750.819 253.653 Q750.819 260.019 747.648 263.653 Q744.476 267.264 738.921 267.264 Q733.342 267.264 730.171 263.653 Q727.023 260.019 727.023 253.653 Q727.023 247.264 730.171 243.653 Q733.342 240.042 738.921 240.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M757.879 230.574 L762.138 230.574 L762.138 266.593 L757.879 266.593 L757.879 230.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M770.61 256.361 L770.61 240.667 L774.87 240.667 L774.87 256.199 Q774.87 259.88 776.305 261.732 Q777.74 263.56 780.61 263.56 Q784.059 263.56 786.05 261.361 Q788.064 259.162 788.064 255.366 L788.064 240.667 L792.323 240.667 L792.323 266.593 L788.064 266.593 L788.064 262.611 Q786.513 264.972 784.453 266.13 Q782.416 267.264 779.708 267.264 Q775.24 267.264 772.925 264.486 Q770.61 261.708 770.61 256.361 M781.328 240.042 L781.328 240.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M805.309 233.306 L805.309 240.667 L814.082 240.667 L814.082 243.977 L805.309 243.977 L805.309 258.051 Q805.309 261.222 806.166 262.125 Q807.045 263.028 809.707 263.028 L814.082 263.028 L814.082 266.593 L809.707 266.593 Q804.777 266.593 802.902 264.764 Q801.027 262.912 801.027 258.051 L801.027 243.977 L797.902 243.977 L797.902 240.667 L801.027 240.667 L801.027 233.306 L805.309 233.306 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M819.684 240.667 L823.944 240.667 L823.944 266.593 L819.684 266.593 L819.684 240.667 M819.684 230.574 L823.944 230.574 L823.944 235.968 L819.684 235.968 L819.684 230.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M842.902 243.653 Q839.476 243.653 837.485 246.338 Q835.494 249 835.494 253.653 Q835.494 258.306 837.462 260.991 Q839.453 263.653 842.902 263.653 Q846.304 263.653 848.295 260.968 Q850.286 258.282 850.286 253.653 Q850.286 249.046 848.295 246.361 Q846.304 243.653 842.902 243.653 M842.902 240.042 Q848.457 240.042 851.629 243.653 Q854.8 247.264 854.8 253.653 Q854.8 260.019 851.629 263.653 Q848.457 267.264 842.902 267.264 Q837.323 267.264 834.152 263.653 Q831.004 260.019 831.004 253.653 Q831.004 247.264 834.152 243.653 Q837.323 240.042 842.902 240.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /><path clip-path="url(#clip310)" d="M883.411 250.945 L883.411 266.593 L879.152 266.593 L879.152 251.083 Q879.152 247.403 877.716 245.574 Q876.281 243.746 873.411 243.746 Q869.962 243.746 867.971 245.945 Q865.98 248.144 865.98 251.94 L865.98 266.593 L861.698 266.593 L861.698 240.667 L865.98 240.667 L865.98 244.695 Q867.508 242.357 869.568 241.199 Q871.652 240.042 874.36 240.042 Q878.827 240.042 881.119 242.82 Q883.411 245.574 883.411 250.945 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1" /></svg>
<p>Here we use the <code>get_ps</code> function to retrieve a full parameter set using the optimal parameters. Alternatively, the <code>ODEProblem</code> or fitted simulation can be retrieved directly using the <code>get_odeproblem</code> or <code>get_odesol</code> <a href="https://sebapersson.github.io/PEtab.jl/dev/API_choosen/#PEtab.get_odeproblem">functions</a>, respectively (and the initial condition using the <code>get_u0</code> function). The calibration result can also be found in <code>res.xmin</code>, however, note that PEtab automatically (<a href="#petab_parameters_scales">unless a linear scale is selected</a>) converts parameters to logarithmic scale, so typically <code>10 .^res.xmin</code> are the values of interest. If you investigate the result from this example you might note that the found parameter set (while it fits the data well) does not correspond to the true parameter set. This phenomenon is related to <em>identifiability</em>, and is very important for parameter fitting.</p><h3 id="Final-notes"><a class="docs-heading-anchor" href="#Final-notes">Final notes</a><a id="Final-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Final-notes" title="Permalink"></a></h3><p>PEtab.jl also supports <a href="#petab_multistart_optimisation">multistart optimisation</a>, <a href="https://sebapersson.github.io/PEtab.jl/stable/Brannmark/">automatic pre-equilibration before simulations</a>, and <a href="#petab_events">events</a>. Various <a href="#petab_plotting">plot recipes</a> exist for investigating the optimisation process. Please read the <a href="https://sebapersson.github.io/PEtab.jl/stable/">PETab.jl documentation</a> for a more complete description of the package&#39;s features. Below follows additional details of various options and features (generally, PEtab is able to find good default values for most options not specified).</p><h2 id="petab_observables"><a class="docs-heading-anchor" href="#petab_observables">Additional features: Observables</a><a id="petab_observables-1"></a><a class="docs-heading-anchor-permalink" href="#petab_observables" title="Permalink"></a></h2><h3 id="petab_observables_observables"><a class="docs-heading-anchor" href="#petab_observables_observables">Defining non-trivial observables</a><a id="petab_observables_observables-1"></a><a class="docs-heading-anchor-permalink" href="#petab_observables_observables" title="Permalink"></a></h3><p>It is possible for observables to be any algebraic expression of species concentrations and parameters. E.g. in this example the total amount of <code>X</code> in the system is an observable:</p><pre><code class="language-julia hljs">rn = @reaction_network begin
    (k1,k2), X1 &lt;--&gt; X2
end
@unpack X1, X2 = rn
obs_X = PEtabObservable(X1 + X2, 0.5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabObservable: h = X1(t) + X2(t), noise-formula = 0.5 and normal (Gaussian) measurement noise</code></pre><p>A common application for this is to define an <a href="https://sebapersson.github.io/PEtab.jl/stable/Define_in_julia/#Defining-the-Observable"><em>offset</em> and a <em>scale</em> for each observable</a>.</p><h3 id="petab_observables_noise_formula"><a class="docs-heading-anchor" href="#petab_observables_noise_formula">Advanced observables noise formulas</a><a id="petab_observables_noise_formula-1"></a><a class="docs-heading-anchor-permalink" href="#petab_observables_noise_formula" title="Permalink"></a></h3><p>In our basic example we assumed that the normally distributed noise had a standard deviation of <code>0.5</code>. However, this value may be a parameter (or indeed any algebraic expression). E.g, we could set</p><pre><code class="language-julia hljs">@parameters σ
obs_P = PEtabObservable(P, σ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabObservable: h = P(t), noise-formula = σ and normal (Gaussian) measurement noise</code></pre><p>and then let the parameter <em>σ</em> vary between different <a href="#petab_simulation_conditions">simulation conditions</a>. Alternatively we could let the noise scale linearly with the species&#39; concentration:</p><pre><code class="language-julia hljs">obs_P = PEtabObservable(P, 0.05P)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabObservable: h = P(t), noise-formula = 0.05P(t) and normal (Gaussian) measurement noise</code></pre><p>It would also be possible to make <em>σ</em> a <em>parameter that is fitted as a part of the parameter fitting process</em>.</p><p>PEtab.jl assumes that noise is normally distributed (with a standard deviation equal to the second argument provided to <code>PEtabObservable</code>). The only other (currently implemented) noise distribution is log-normally distributed noise, which is designated through the <code>transformation=:log</code> argument:</p><pre><code class="language-julia hljs">obs_P = PEtabObservable(P, σ; transformation=:log)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabObservable: h = P(t), noise-formula = σ and log-normal measurement noise</code></pre><h2 id="petab_parameters"><a class="docs-heading-anchor" href="#petab_parameters">Additional features: Parameters</a><a id="petab_parameters-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameters" title="Permalink"></a></h2><h3 id="petab_parameters_known"><a class="docs-heading-anchor" href="#petab_parameters_known">Known parameters</a><a id="petab_parameters_known-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameters_known" title="Permalink"></a></h3><p>In our previous example, all parameters were unknowns that we wished to fit to the data. If any parameters have known values, it is possible to provide these to <code>PEtabModel</code> through the <code>parameter_map</code> argument. E.g if we had known that <em>kB = 1.0</em>, then we would only define <em>kD</em> and <em>kP</em> as parameters we wish to fit:</p><pre><code class="language-julia hljs">par_kD = PEtabParameter(:kD)
par_kP = PEtabParameter(:kP)
params = [par_kD, par_kP]</code></pre><p>We then provide <code>parameter_map=[:kB =&gt; 1.0]</code> when we assembly our model:</p><pre><code class="language-julia hljs">petab_model = PEtabModel(rn, observables, measurements, params; state_map=u0, parameter_map=[:kB =&gt; 1.0])</code></pre><h3 id="petab_parameters_bounds"><a class="docs-heading-anchor" href="#petab_parameters_bounds">Parameter bounds</a><a id="petab_parameters_bounds-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameters_bounds" title="Permalink"></a></h3><p>By default, when fitted, potential parameter values are assumed to be in the interval <em>[1e-3, 1e3]</em>. When declaring a <code>PEtabParameter</code> it is possible to change these values through the <code>lb</code> and <code>ub</code> arguments. E.g. we could use</p><pre><code class="language-julia hljs">par_kB = PEtabParameter(:kB; lb=1e-2, ub=1e-2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabParameter kB. Estimated on log10-scale with bounds [1.0e-02, 1.0e-02]</code></pre><p>to achieve the more conservative bound <em>[1e-2, 1e2]</em> for the parameter <em>kB</em>.</p><h3 id="petab_parameters_scales"><a class="docs-heading-anchor" href="#petab_parameters_scales">Parameter scales</a><a id="petab_parameters_scales-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameters_scales" title="Permalink"></a></h3><p>Internally, parameters that are fitted are converted to a logarithmic scale (generally, this is considered advantageous<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>). To prevent this conversion, the <code>scale=:lin</code> argument can be used. Here we change the scale of <em>kB</em> to linear:</p><pre><code class="language-julia hljs">par_kB = PEtabParameter(:kB; scale=:lin)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabParameter kB. Estimated on lin-scale with bounds [1.0e-03, 1.0e+03]</code></pre><h3 id="petab_parameters_priors"><a class="docs-heading-anchor" href="#petab_parameters_priors">Parameter priors</a><a id="petab_parameters_priors-1"></a><a class="docs-heading-anchor-permalink" href="#petab_parameters_priors" title="Permalink"></a></h3><p>If we has prior knowledge about the distribution of a parameter, it is possible to incorporate this into the model. The prior can be any continuous, univariate, distribution from the <a href="https://github.com/JuliaStats/Distributions.jl">Distributions.jl package</a>. E.g we can use:</p><pre><code class="language-julia hljs">using Distributions
par_kB = PEtabParameter(:kB; prior=Normal(1.0,0.2))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabParameter kB. Estimated on log10-scale with bounds [1.0e-03, 1.0e+03] and prior Distributions.Normal{Float64}(μ=1.0, σ=0.2)</code></pre><p>to set a normally distributed prior (with mean <code>1.0</code> and standard deviation <code>0.2</code>) on the value of <em>kB</em>. By default, the prior is assumed to be on the linear scale of the parameter (before any potential log transform). To specify that the prior is on the logarithmic scale, the <code>prior_on_linear_scale=false</code> argument can be provided:</p><pre><code class="language-julia hljs">par_kB = PEtabParameter(:kB; prior=Normal(1.0,0.2), prior_on_linear_scale=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabParameter kB. Estimated on log10-scale with bounds [1.0e-03, 1.0e+03] and prior Distributions.Normal{Float64}(μ=1.0, σ=0.2)</code></pre><p>In this example, setting <code>prior_on_linear_scale=false</code> make sense as a (linear) normal distribution is non-zero for negative values (an alternative is to use a log-normal distribution, e.g. <code>prior=LogNormal(3.0, 3.0)</code>).</p><h2 id="petab_simulation_conditions"><a class="docs-heading-anchor" href="#petab_simulation_conditions">Simulation conditions</a><a id="petab_simulation_conditions-1"></a><a class="docs-heading-anchor-permalink" href="#petab_simulation_conditions" title="Permalink"></a></h2><p>Sometimes, we have data from several different experimental conditions. Here, when a potential parameter set is evaluated during the fitting process, each experimental condition corresponds to one simulation condition (which produces one simulation). To account for this, PEtab permits the user to define several different simulation conditions, with each condition being defined by specific values for some initial conditions and/or parameters. </p><p>If, for our previous catalysis example, we had measured the system for two different initial values of <em>S</em> (<em>S(0)=1.0</em> and <em>S(0)=0.5</em>), these would correspond to two different simulation conditions. For each condition we define a <code>Dict</code> mapping the species to their initial condition (here, <em>S</em> is the only species in each <code>Dict</code>):</p><pre><code class="language-julia hljs">c1 = Dict(:S =&gt; 1.0)
c2 = Dict(:S =&gt; 0.5)</code></pre><p>Similarly as for observables, we then gather the conditions in another <code>Dict</code>, giving each an id tag:</p><pre><code class="language-julia hljs">simulation_conditions = Dict(&quot;c1&quot; =&gt; c1, &quot;c2&quot; =&gt; c2)</code></pre><p>Again (like for observables), each measurement in the measurements <code>DataFrame</code> needs to be associated with a simulation condition id tag (describing which condition that measurements were taken from). Parameters, just like initial conditions, may vary between different conditions. If an initial condition (or parameter) occurs in one condition, it must occur in all of them.</p><p>Here follows a complete version of our basic example, but with measurements both for <em>S(0)=1.0</em> and <em>S(0)=0.5</em>.</p><pre><code class="language-julia hljs">using Catalyst, PEtab

rn = @reaction_network begin
    kB, S + E --&gt; SE
    kD, SE --&gt; S + E
    kP, SE --&gt; P + E
end

u0 = [:E =&gt; 1.0, :SE =&gt; 0.0, :P =&gt; 0.0]
p_true = [:kB =&gt; 1.0, :kD =&gt; 0.1, :kP =&gt; 0.5]

# Simulate data.
using OrdinaryDiffEq, Random
d1, t1 = let
    oprob = ODEProblem(rn, [:S=&gt;1.0; u0], (0.0, 10.0), p_true)
    sol = solve(oprob, Tsit5(); saveat=0.1)
    ((0.8 .+ 0.4*rand(10)) .* sol[:P][10:10:end], sol.t[10:10:end])
end
d2, t2 = let
    oprob = ODEProblem(rn, [:S=&gt;0.5; u0], (0.0, 10.0), p_true)
    sol = solve(oprob, Tsit5(); saveat=0.1)
    ((0.8 .+ 0.4*rand(10)) .* sol[:P][10:10:end], sol.t[10:10:end])
end

@unpack P = rn
obs_P = PEtabObservable(P, 0.5)
observables = Dict(&quot;obs_P&quot; =&gt; obs_P)

par_kB = PEtabParameter(:kB)
par_kD = PEtabParameter(:kD)
par_kP = PEtabParameter(:kP)
params = [par_kB, par_kD, par_kP]

c1 = Dict(:kB =&gt; 1.0)
c2 = Dict(:kB =&gt; 0.5)
simulation_conditions = Dict(&quot;c1&quot; =&gt; c1, &quot;c2&quot; =&gt; c2)

using DataFrames
m1 = DataFrame(simulation_id=&quot;c1&quot;, obs_id=&quot;obs_P&quot;, time=t1, measurement=d1)
m2 = DataFrame(simulation_id=&quot;c2&quot;, obs_id=&quot;obs_P&quot;, time=t2, measurement=d2)
measurements = vcat(m1,m2)

petab_model = PEtabModel(rn, simulation_conditions, observables, measurements, params; state_map=u0)</code></pre><p>Note that the <code>u0</code> we pass into <code>PEtabModel</code> through the <code>state_map</code> argument no longer contains the value of <em>S</em> (as it is provided by the conditions). </p><h3 id="Varying-parameters-between-different-simulation-conditions"><a class="docs-heading-anchor" href="#Varying-parameters-between-different-simulation-conditions">Varying parameters between different simulation conditions</a><a id="Varying-parameters-between-different-simulation-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Varying-parameters-between-different-simulation-conditions" title="Permalink"></a></h3><p>Sometimes, the parameters that are used vary between the different conditions. Consider our catalysis example, if we had performed the experiment twice, using two different enzymes with different catalytic properties, this could have generated such conditions. The two enzymes could e.g. yield different rates (<em>kP₁</em> and <em>kP₂</em>) for the <code>SE --&gt; P + E</code> reaction, but otherwise be identical. Here, the parameters <em>kP₁</em> and <em>kP₂</em> are unique to their respective conditions. PEtab.jl provides support for cases such as this, and <a href="https://sebapersson.github.io/PEtab.jl/stable/Julia_condition_specific/">its documentation</a> provided instructions of how to handle them.</p><h2 id="petab_simulation_initial_conditions"><a class="docs-heading-anchor" href="#petab_simulation_initial_conditions">Additional features: Initial conditions</a><a id="petab_simulation_initial_conditions-1"></a><a class="docs-heading-anchor-permalink" href="#petab_simulation_initial_conditions" title="Permalink"></a></h2><h3 id="petab_simulation_initial_conditions_fitted"><a class="docs-heading-anchor" href="#petab_simulation_initial_conditions_fitted">Fitting initial conditions</a><a id="petab_simulation_initial_conditions_fitted-1"></a><a class="docs-heading-anchor-permalink" href="#petab_simulation_initial_conditions_fitted" title="Permalink"></a></h3><p>Sometimes, initial conditions are uncertain quantities which we wish to fit to the data. This is possible by <a href="../../catalyst_functionality/dsl_description/#dsl_description_parametric_initial_conditions">defining an initial condition as a parameter</a>: </p><pre><code class="language-julia hljs">rn = @reaction_network begin
    @parameters E0
    @species E(t)=E0
    kB, S + E --&gt; SE
    kD, SE --&gt; S + E
    kP, SE --&gt; P + E
end</code></pre><p>Here, the initial value of <code>E</code> is equal to the parameter <code>E0</code>. We modify our <code>u0</code> vector by removing <code>E</code> (which is no longer known):</p><pre><code class="language-julia hljs">u0 = [:S =&gt; 1.0, :SE =&gt; 0.0, :P =&gt; 0.0]</code></pre><p>Next, we add <code>E0</code> to the parameters we wish to fit:</p><pre><code class="language-julia hljs">par_kB = PEtabParameter(:kB)
par_kD = PEtabParameter(:kD)
par_kP = PEtabParameter(:kP)
par_E0 = PEtabParameter(:E0)
params = [par_kB, par_kD, par_kP, par_E0]</code></pre><p>and we can use our updated <code>rn</code>, <code>u0</code>, and <code>params</code> as input to our <code>PEtabModel</code>.</p><h3 id="petab_simulation_initial_conditions_uncertainty"><a class="docs-heading-anchor" href="#petab_simulation_initial_conditions_uncertainty">Uncertain initial conditions</a><a id="petab_simulation_initial_conditions_uncertainty-1"></a><a class="docs-heading-anchor-permalink" href="#petab_simulation_initial_conditions_uncertainty" title="Permalink"></a></h3><p>Often, while an initial condition has been reported for an experiment, its exact value is uncertain. This can be modelled by making the initial condition a <a href="#petab_simulation_initial_conditions_fitted">parameter that is fitted to the data</a> and attach a prior to it corresponding to our certainty about its value. </p><p>Let us consider our initial example, but where we want to add uncertainty to the initial conditions of <code>S</code> and <code>E</code>. We will add priors on these, assuming normal distributions with mean <code>1.0</code> and standard deviation <code>0.1</code>. For the synthetic measured data we will use the true values <em>S(0)=E(0)=1.0</em>.</p><pre><code class="language-julia hljs">using Catalyst, PEtab

rn = @reaction_network begin
    @parameters S0 E0
    @species S(t)=S0 E(t)=E0
    kB, S + E --&gt; SE
    kD, SE --&gt; S + E
    kP, SE --&gt; P + E
end

u0 = [:SE =&gt; 0.0, :P =&gt; 0.0]
p_true = [:kB =&gt; 1.0, :kD =&gt; 0.1, :kP =&gt; 0.5, :S0=&gt;1.0, :E0 =&gt; 1.0]

using OrdinaryDiffEq, Random
oprob = ODEProblem(rn, [:S=&gt;1.0; :E =&gt; 1.0; u0], (0.0, 10.0), p_true)
sol = solve(oprob, Tsit5(); saveat=0.1)
data = (0.8 .+ 0.4*rand(10)) .* sol[:P][10:10:end]

@unpack P = rn
obs_P = PEtabObservable(P, 0.5)
observables = Dict(&quot;obs_P&quot; =&gt; obs_P)

par_kB = PEtabParameter(:kB)
par_kD = PEtabParameter(:kD)
par_kP = PEtabParameter(:kP)
par_S0 = PEtabParameter(:S0)
par_E0 = PEtabParameter(:E0)
params = [par_kB, par_kD, par_kP, par_S0, par_E0]

using DataFrames
measurements = DataFrame(obs_id=&quot;obs_P&quot;, time=sol.t[10:10:end], measurement=data)

petab_model = PEtabModel(rn, observables, measurements, params; state_map=u0)</code></pre><p>Here, when we fit our data we will also gain values for <code>S0</code> and <code>E0</code>, however, unless we are explicitly interested in these, they can be ignored.</p><h2 id="petab_simulation_options"><a class="docs-heading-anchor" href="#petab_simulation_options">Additional features: Simulation options</a><a id="petab_simulation_options-1"></a><a class="docs-heading-anchor-permalink" href="#petab_simulation_options" title="Permalink"></a></h2><p>While in our basic example, we do not provide any additional information to our <code>PEtabODEProblem</code>, this is an opportunity to specify how the model should be simulated, and what automatic differentiation techniques to use for the optimisation procedure (if none are provided, appropriate defaults are selected). </p><p>Here is an example, taken from the <a href="https://sebapersson.github.io/PEtab.jl/dev/Boehm/#Creating-a-PEtabODEProblem">more detailed PEtab.jl documentation</a></p><pre><code class="language-julia hljs">petab_problem = PEtabODEProblem(petab_model,
                                ode_solver=ODESolver(Rodas5P(), abstol=1e-8, reltol=1e-8),
                                gradient_method=:ForwardDiff,
                                hessian_method=:ForwardDiff)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Building PEtabODEProblem for ReactionSystemModel
[ Info: Building ODEProblem from ODESystem ... done. Time = 1.0e-02
[ Info: Building cost function for method Standard ... done. Time = 1.0e-05
[ Info: Building gradient function for method ForwardDiff ... done. Time = 1.0e-02
[ Info: Building hessian function for method ForwardDiff ... done. Time = 3.8e-02</code></pre><p>where we simulate our ODE model using the <code>Rodas5p</code> method (with absolute and relative tolerance both equal <code>1e-8</code>) and use <a href="https://github.com/JuliaDiff/ForwardDiff.jl">forward automatic differentiation</a> for both gradient and hessian computation. More details on available ODE solver options can be found in <a href="https://sebapersson.github.io/PEtab.jl/dev/API_choosen/#PEtab.ODESolver">the PEtab.jl documentation</a>.</p><h2 id="petab_optimisation"><a class="docs-heading-anchor" href="#petab_optimisation">Additional features: Optimisation</a><a id="petab_optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#petab_optimisation" title="Permalink"></a></h2><h3 id="petab_optimisation_optimisers"><a class="docs-heading-anchor" href="#petab_optimisation_optimisers">Optimisation methods and options</a><a id="petab_optimisation_optimisers-1"></a><a class="docs-heading-anchor-permalink" href="#petab_optimisation_optimisers" title="Permalink"></a></h3><p>For our examples, we have used the <code>Optim.IPNewton</code> optimisation method. PEtab.jl supports <a href="https://sebapersson.github.io/PEtab.jl/dev/Avaible_optimisers/#options_optimisers">several additional optimisation methods</a>. Furthermore, <code>calibrate_model</code>&#39;s <code>options</code> argument permits the customisation of the options for any used optimiser. E.g. to designate the maximum number of iterations of the <code>Optim.IPNewton</code> method we would use:</p><pre><code class="language-julia hljs">res = calibrate_model(petab_problem, p0, IPNewton(); options=Optim.Options(iterations = 10000))</code></pre><p>Please read the <a href="https://sebapersson.github.io/PEtab.jl/dev/Avaible_optimisers/#options_optimisers">PEtab.jl documentation</a> to learn how to customise the various optimisers&#39; properties. </p><h3 id="petab_optimisation_path_recording"><a class="docs-heading-anchor" href="#petab_optimisation_path_recording">Optimisation path recording</a><a id="petab_optimisation_path_recording-1"></a><a class="docs-heading-anchor-permalink" href="#petab_optimisation_path_recording" title="Permalink"></a></h3><p>To record all the parameter sets evaluated (and their objective values) during the optimisation procedure, provide the <code>save_trace=true</code> argument to <code>calibrate_model</code> (or <code>calibrate_model_multistart</code>). This is required for the various <a href="#petab_plotting">optimisation evaluation plots</a> provided by PEtab.jl. If desired, this information can be accessed in the calibration output&#39;s <code>.xtrace</code> and <code>.ftrace</code> fields.</p><h2 id="Objective-function-extraction"><a class="docs-heading-anchor" href="#Objective-function-extraction">Objective function extraction</a><a id="Objective-function-extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Objective-function-extraction" title="Permalink"></a></h2><p>While PEtab.jl provides various tools for analysing the objective function generated by <code>PEtabODEProblem</code>, it is also possible to extract this function for customised analysis. Given a <code>PEtabODEProblem</code></p><pre><code class="language-julia hljs">petab_problem = PEtabODEProblem(petab_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Building PEtabODEProblem for ReactionSystemModel
[ Info: Building ODEProblem from ODESystem ... done. Time = 1.1e-02
[ Info: Building cost function for method Standard ... done. Time = 9.5e-06
[ Info: Building gradient function for method ForwardDiff ... done. Time = 1.6e-05
[ Info: Building hessian function for method ForwardDiff ... done. Time = 1.6e-05</code></pre><p>We can find the:</p><ol><li>Objective function in the <code>petab_problem.compute_cost</code>. It takes a single argument (<code>p</code>) and returns the objective value.</li><li>Gradient in the <code>petab_problem.compute_gradient!</code> field. It takes two arguments (<code>g</code> and <code>p</code>) with the updated gradient values being written to <code>g</code>.</li><li>Hessian in the <code>petab_problem.compute_hessian</code> field. It takes two arguments (<code>H</code> and <code>p</code>) with the updated hessian values being written to <code>H</code>.</li></ol><h2 id="petab_multistart_optimisation"><a class="docs-heading-anchor" href="#petab_multistart_optimisation">Multi-start optimisation</a><a id="petab_multistart_optimisation-1"></a><a class="docs-heading-anchor-permalink" href="#petab_multistart_optimisation" title="Permalink"></a></h2><p>To avoid the optimisation process returning a local minimum, it is often advised to run it multiple times, using different initial guesses. PEtab.jl supports this through the <code>calibrate_model_multistart</code> function. This is identical to the <code>calibrate_model</code> function, but takes two additional arguments:</p><ol><li><code>n_multistart</code>: The number of runs to perform.</li><li><code>dir_save</code>: A location to which the output is saved. If <code>dir_save=nothing</code>, no output is saved.</li></ol><p>And one additional optional argument:</p><ol><li><code>sampling_method</code>: Selects the sampling method with which to select the initial guesses (<code>QuasiMonteCarlo.LatinHypercubeSample()</code> used by default). </li></ol><p>Because <code>calibrate_model_multistart</code> handles initial guess sampling, unlike for <code>calibrate_model</code>, no initial guess has to be provided. </p><p>Here, we fit parameters through 10 independent optimisation runs, using QuasiMonteCarlo&#39;s <code>SobolSample</code> method, and save the result to the OptimizationRuns folder:</p><pre><code class="language- hljs">using Optim
using QuasiMonteCarlo
res_ms = calibrate_model_multistart(petab_problem, IPNewton(), 10, &quot;OptimizationRuns&quot;; sampling_method=QuasiMonteCarlo.SobolSample())</code></pre><p>The best result across all runs can still be retrieved using <code>get_ps(res_ms, petab_problem)</code>, with the results of the individual runs being stored in the <code>res_ms.runs</code> field. </p><p>To load the result in a later session, we can call:</p><pre><code class="language- hljs">res_ms = PEtabMultistartOptimisationResult(&quot;OptimizationRuns&quot;)</code></pre><p>If the OptimizationRuns folder contains the output from several runs, we can designate which to load using the <code>which_run</code> argument. Here we loads the second run to be saved in that folder:</p><pre><code class="language- hljs">res_ms = PEtabMultistartOptimisationResult(&quot;OptimizationRuns&quot;; which_run=&quot;2&quot;)</code></pre><h2 id="petab_events"><a class="docs-heading-anchor" href="#petab_events">Events</a><a id="petab_events-1"></a><a class="docs-heading-anchor-permalink" href="#petab_events" title="Permalink"></a></h2><p>So far, we have assumed that all experiments, after initiation, run without interference. Experiments where conditions change, or where species are added/removed during the time course, can be represented through events (related to <a href="../../catalyst_applications/advanced_simulations/#advanced_simulations_callbacks">callbacks</a>). In PEtab, an event is represented through the <code>PEtabEvent</code> structure. It takes three arguments:</p><ol><li>The condition for triggering the event. This can either indicate a point in time, or a boolean condition.</li><li>A rule for updating the event&#39;s target</li><li>The event&#39;s target (either a species or parameter).</li></ol><p>Here we create an event which adds <code>0.5</code> units of <code>S</code> to the system at time <code>5.0</code>:</p><pre><code class="language-julia hljs">@unpack S = rn
event1 = PEtabEvent(5.0, S + 0.5, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabEvent: condition t == 5.0, affect S(t) = 0.5 + S(t)</code></pre><p>Here, the first argument is evaluated to a scalar value, in which case it is interpreted as a time point at which the event happens. If we instead want the event to happen whenever the concentration of <code>S</code> falls below <code>0.5</code> we set the first argument to a boolean condition indicating this:</p><pre><code class="language-julia hljs">event2 = PEtabEvent(S &lt; 0.5, S + 0.5, S)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PEtabEvent: condition S(t) &lt; 0.5, affect S(t) = 0.5 + S(t)</code></pre><p>Here, the event only triggers whenever the condition changes from <code>false</code> to <code>true</code>, and not while it remains <code>true</code> (or when changing from <code>true</code> to <code>false</code>). E.g. this event only triggers when <code>S</code> concentration passes from more than <em>5.0</em> to less that <em>5.0</em>.</p><p>Whenever we have several events or not, we bundle them together in a single vector which is later passed to the <code>PEtabODEProblem</code> using the <code>events</code> argument:</p><pre><code class="language- hljs">events = [event, event2]
petab_model = PEtabModel(rn, observables, measurements, params; state_map=u0, events=events)</code></pre><p>More details on how to use events, including how to create events with multiple targets, can be found in <a href="https://sebapersson.github.io/PEtab.jl/stable/Julia_event/">PEtab.jl&#39;s documentation</a>.</p><h2 id="petab_plotting"><a class="docs-heading-anchor" href="#petab_plotting">Plot recipes</a><a id="petab_plotting-1"></a><a class="docs-heading-anchor-permalink" href="#petab_plotting" title="Permalink"></a></h2><p>There exist various types of graphs that can be used to evaluate the parameter fitting process. These can be plotted using the <code>plot</code> command, where the input is either the result of a <code>calibrate_model</code> or a  <code>calibrate_model_multistart</code> run. To be able to use this functionality, you have to ensure that PEtab.jl <a href="#petab_optimisation_path_recording">records the optimisation process</a> by providing the <code>save_trace=true</code> argument to the calibration functions.</p><p>To, for a single start calibration run, plot, for each iteration of the optimization process, the best objective value achieved so far, run:</p><pre><code class="language- hljs">plot(res)</code></pre><p>For a multi-start calibration run, the default output is instead a so-called waterfall plot:</p><pre><code class="language- hljs">plot(res_ms)</code></pre><p><img src="../../assets/petab_waterfall.svg" alt="petab waterfall plot"/> (for this, and the next plot, we use a multi-start optimisation result from a different model, which yields less trivial optimisation runs than our catalysis one)</p><p>In the waterfall plot, each dot shows the final objective value for a single run in the multi-start process. The runs are ordered by their objective values, and colours designate runs in the same local minimum. A common use of waterfall plots is to check whether a sufficient number of runs (typically <em>&gt;5</em>) has converged to the same best local minimum (in which case it is assumed to be the <em>global</em> minimum).</p><p>To instead use the best objective value plot for a multi-start run (with one curve for each run), the <code>plot_type</code> argument is used:</p><pre><code class="language- hljs">plot(res_ms; plot_type = :best_objective)</code></pre><p><img src="../../assets/petab_best_objective.svg" alt="petab best objective plot"/></p><p>There exist several types of plots for both types of calibration results. More details of the types of available plots, and how to customise them, can be found <a href="https://sebapersson.github.io/PEtab.jl/stable/optimisation_output_plotting/">here</a>.</p><h2 id="petab_citations"><a class="docs-heading-anchor" href="#petab_citations">Citations</a><a id="petab_citations-1"></a><a class="docs-heading-anchor-permalink" href="#petab_citations" title="Permalink"></a></h2><p>If you use this functionality in your research, <a href="../../#catalyst_citation">in addition to Catalyst</a>, please cite the following papers to support the authors of the PEtab.jl package (currently there is no article associated with this package) and the PEtab standard:</p><pre><code class="nohighlight hljs">@misc{2023Petabljl,
  author       = {Ognissanti, Damiano AND Arutjunjan, Rafael AND Persson, Sebastian AND Hasselgren, Viktor},
  title        = {{2023Petabljl.jl}},
  howpublished = {\url{https://github.com/sebapersson/PEtab.jl/}},
  year         = {2023}
}</code></pre><pre><code class="nohighlight hljs">@article{SchmiesterSch2021,
  author    = {Schmiester, Leonard AND Schälte, Yannik AND Bergmann, Frank T. AND Camba, Tacio AND Dudkin, Erika AND Egert, Janine AND Fröhlich, Fabian AND Fuhrmann, Lara AND Hauber, Adrian L. AND Kemmer, Svenja AND Lakrisenko, Polina AND Loos, Carolin AND Merkt, Simon AND Müller, Wolfgang AND Pathirana, Dilan AND Raimúndez, Elba AND Refisch, Lukas AND Rosenblatt, Marcus AND Stapor, Paul L. AND Städter, Philipp AND Wang, Dantong AND Wieland, Franz-Georg AND Banga, Julio R. AND Timmer, Jens AND Villaverde, Alejandro F. AND Sahle, Sven AND Kreutz, Clemens AND Hasenauer, Jan AND Weindl, Daniel},
  journal   = {PLOS Computational Biology},
  title     = {PEtab—Interoperable specification of parameter estimation problems in systems biology},
  year      = {2021},
  month     = {01},
  number    = {1},
  pages     = {1-10},
  volume    = {17},
  doi       = {10.1371/journal.pcbi.1008646},
  publisher = {Public Library of Science},
  url       = {https://doi.org/10.1371/journal.pcbi.1008646},
}</code></pre><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a><a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1008646">Schmiester, L et al. <em>PEtab—Interoperable specification of parameter estimation problems in systems biology</em>, PLOS Computational Biology (2021).</a></li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a><a href="https://academic.oup.com/bioinformatics/article/35/17/3073/5280731?login=false">Hass, H et al. <em>PBenchmark problems for dynamic modeling of intracellular processes</em>, Bioinformatics (2019).</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parameter_estimation/">« Parameter Estimation</a><a class="docs-footer-nextpage" href="../../faqs/">FAQs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 2 November 2023 23:50">Thursday 2 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
